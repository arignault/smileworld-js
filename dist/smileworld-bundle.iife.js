(function(){"use strict";console.log("🚀 loading-screen.js v1.4.0 chargé");const v={logoPopDuration:.3,fadeOutDuration:.4,ease:"power2.out",logoShrinkScale:.8};let k=!1,b=!1,D=!1,R=!1;function H(){D&&R&&Y()}function K(){try{if(sessionStorage.getItem("preloaderShown")){console.log("✅ Preloader déjà affiché dans cette session, on le cache immédiatement.");const o=document.querySelector(".loadingscreen");return o&&(o.style.display="none"),k=!0,b=!0,Promise.resolve()}}catch(o){console.warn("Impossible d'accéder à sessionStorage, le preloader s'affichera à chaque fois.",o)}if(console.log("🎬 initLoadingScreen - Début de l'initialisation (0.9s)"),k)return console.log("ℹ️ Écran de chargement déjà initialisé"),Promise.resolve();const t=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");return console.log("🔍 Éléments trouvés:",{loadingScreen:!!t,logoWrap:!!e}),!t||!e?(console.warn("⚠️ Éléments manquants:",{loadingScreen:t?"OK":"Non trouvé",logoWrap:e?"OK":"Non trouvé"}),k=!1,Promise.resolve(null)):(console.log("🎨 Configuration des styles initiaux"),window.gsap.set(t,{opacity:1,display:"flex",backgroundColor:"white"}),window.gsap.set(e,{opacity:0,scale:.9}),window.gsap.to(e,{opacity:1,scale:1,duration:.5,delay:.1,ease:v.ease}),setTimeout(()=>{console.log("⏱️ 0.9 secondes écoulées."),R=!0,H()},900),k=!0,console.log("✅ Écran de chargement initialisé avec succès (0.9s)"),Promise.resolve(t))}function X(){console.log("🟢 Application prête, demande de masquage de l'écran de chargement."),D=!0,H()}function Y(){if(console.log("🎬 hideLoadingScreen - Début du masquage"),!k){console.warn("⚠️ Écran de chargement non initialisé");return}if(b){console.log("ℹ️ Masquage déjà en cours");return}b=!0;const t=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");if(console.log("🔍 Éléments trouvés pour le masquage:",{loadingScreen:!!t,logoWrap:!!e}),!t||!e){console.warn("⚠️ Éléments manquants pour le masquage"),b=!1;return}console.log("🎬 Démarrage de l'animation de masquage améliorée"),window.gsap.timeline({onComplete:()=>{console.log("✅ Animation de masquage terminée"),window.gsap.set(t,{display:"none"}),b=!1;try{sessionStorage.setItem("preloaderShown","true")}catch(n){console.warn("Impossible d'enregistrer l'état du preloader dans sessionStorage.",n)}}}).to(e,{opacity:0,scale:v.logoShrinkScale,duration:v.logoPopDuration,ease:v.ease}).to(t,{opacity:0,duration:v.fadeOutDuration,ease:v.ease},"-=0.1")}function z(){const t=document.querySelector(".loadingscreen");t&&window.gsap.to(t,{opacity:0,duration:.5,onComplete:()=>{window.gsap.set(t,{display:"none"})}}),b=!1}console.log("🚀 text-animation.js v2.1.0 chargé");function J(){const t=document.querySelector(".span_mover");if(t)try{let n=function(){if(o)return;o=!0;const i=window.gsap.timeline({onComplete:()=>{o=!1,window.gsap.to(t,{y:e.positions.start,duration:e.duration,ease:e.ease,onComplete:()=>{setTimeout(n,e.cycleDelay*1e3)}})}}),a=[e.positions.start,e.positions.middle,e.positions.end];for(let s=0;s<a.length;s++)i.to(t,{y:a[s],duration:e.duration,ease:e.ease}),s<a.length-1&&i.to({},{duration:e.pauseDuration});i.play()};const e={duration:.6,ease:"back.out(1.7)",pauseDuration:1.5,cycleDelay:.5,positions:{start:"0%",middle:"-34%",end:"-68%"}};let o=!1;n(),window.addEventListener("beforeunload",()=>{window.gsap.killTweensOf(t)})}catch(e){console.error("Erreur dans l'animation de texte:",e)}}let A=!1;async function N(t){if(!t||!t.classList.contains("is-open"))return;A=!0;const e=t.querySelector(".faq_respond"),o=t.querySelector(".svg-holder");t.classList.remove("is-open");const n=window.gsap.timeline({onComplete:()=>{e&&(e.style.display="none"),A=!1}});o&&n.to(o,{rotation:0,duration:.25,ease:"power2.inOut"},0),e&&(n.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in"},0),n.to(e,{height:0,duration:.4,ease:"back.in(1.7)"},0)),await n}async function Q(t){if(!t||t.classList.contains("is-open"))return;A=!0;const e=t.querySelector(".faq_respond"),o=t.querySelector(".svg-holder");t.classList.add("is-open");const n=window.gsap.timeline({onComplete:()=>{A=!1}});if(e){window.gsap.set(e,{display:"block",opacity:0,y:-20,height:0}),window.getComputedStyle(e).height,window.gsap.set(e,{height:"auto"});const i=e.scrollHeight;window.gsap.set(e,{height:0}),n.to(e,{height:i,duration:.6,ease:"elastic.out(1.2, 0.5)"},0),n.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out"},"<0.05")}o&&n.to(o,{rotation:90,duration:.25,ease:"back.out(1.7)"},0),await n}async function ee(t){if(A)return;if(t.classList.contains("is-open"))await N(t);else{const o=document.querySelectorAll(".faq_item.is-open");await Promise.all(Array.from(o).map(n=>N(n))),await Q(t)}}function te(){const t=document.querySelectorAll(".faq_item");t.length!==0&&t.forEach(e=>{e&&(e.classList.remove("is-open"),e.querySelector(".faq_respond")&&window.gsap.set(e.querySelector(".faq_respond"),{height:0,opacity:0,display:"none"}),e.querySelector(".svg-holder")&&window.gsap.set(e.querySelector(".svg-holder"),{rotation:0}),!e.dataset.faqInitialized&&(e.dataset.faqInitialized="true",e.addEventListener("click",o=>{o.target.closest(".faq_respond a, .faq_respond button")||(o.preventDefault(),ee(e))})))})}console.log('🚀 menu-desktop.js v14.0.0 chargé - Stratégie "Wrapper"');class oe{constructor(){this.activePanel=null,this.isAnimating=!1,this.triggerSelector='[data-attribute^="nav-link-desktop-"]',this.wrapperSelector=".desktop_menu_wrapper",this.panelClassMap={parcs:".parc_menu_desktop",activites:".activites_menu_desktop",offres:".offres_menu_desktop"},this._addGlobalListener(),console.log('✅ Gestionnaire de clic "Stratégie Wrapper" est actif.')}_addGlobalListener(){document.body.addEventListener("click",e=>{if(this.isAnimating)return;const o=e.target.closest(this.triggerSelector),n=document.querySelector(this.wrapperSelector);if(this.activePanel&&!o&&!this.activePanel.contains(e.target)){this._closeAll();return}if(!o)return;if(e.preventDefault(),e.stopPropagation(),!n){console.error(`Wrapper introuvable avec le sélecteur: ${this.wrapperSelector}`);return}const i=o.getAttribute("data-attribute").replace("nav-link-desktop-",""),a=n.querySelector(this.panelClassMap[i]);if(!a){console.error(`Panneau cible pour la clé "${i}" non trouvé dans le wrapper.`);return}const s=this.activePanel===a,r=!this.activePanel;s?this._closeAll():r?this._openWrapperAndPanel(a):this._switchPanels(this.activePanel,a)})}_openWrapperAndPanel(e){const o=document.querySelector(this.wrapperSelector);this.isAnimating=!0,window.gsap.set(o,{display:"flex",opacity:0}),Object.values(this.panelClassMap).forEach(n=>{const i=o.querySelector(n);i&&window.gsap.set(i,{display:"none"})}),window.gsap.set(e,{display:"flex"}),window.gsap.to(o,{opacity:1,duration:.3,ease:"power2.out",onComplete:()=>{this.isAnimating=!1,this.activePanel=e}})}_closeAll(){const e=document.querySelector(this.wrapperSelector);!this.activePanel||!e||(this.isAnimating=!0,window.gsap.to(e,{opacity:0,duration:.2,ease:"power1.in",onComplete:()=>{window.gsap.set(e,{display:"none"}),this.activePanel&&window.gsap.set(this.activePanel,{display:"none"}),this.activePanel=null,this.isAnimating=!1}}))}_switchPanels(e,o){this.isAnimating=!0;const n=window.gsap.timeline({onComplete:()=>{this.isAnimating=!1,this.activePanel=o}});n.to(e,{opacity:0,duration:.15,onComplete:()=>window.gsap.set(e,{display:"none"})}),n.set(o,{display:"flex",opacity:0}),n.to(o,{opacity:1,duration:.15})}}function ne(){new oe}function ie(){const t=document.querySelector("#hamburger-menu"),e=document.querySelector("#main-menu-mobile"),o=document.body,n=document.querySelector("#parcs-nav_button_mobile"),i=document.querySelector("#activites-nav_button_mobile"),a=document.querySelector("#formules-nav_button_mobile"),s=document.querySelector("#parc-menu-mobile"),r=document.querySelector("#activite-menu-mobile"),l=document.querySelector("#offres-menu-mobile"),d=document.querySelectorAll(".button-close"),u=document.querySelectorAll(".button-back-menu");let c=!1,h=0,C=window.gsap.timeline({paused:!0});const q=window.gsap.timeline({paused:!0});q.to(t,{rotation:90,duration:.4,ease:"elastic.out(1, 0.5)",transformOrigin:"center center"}),[e,s,r,l].forEach(p=>{p.style.display="none"});function E(){h=window.pageYOffset||document.documentElement.scrollTop,o.style.overflow="hidden",o.style.position="fixed",o.style.width="100%",o.style.top=`-${h}px`}function _(){o.style.overflow="",o.style.position="",o.style.width="",o.style.top="",window.scrollTo(0,h)}function L(){return window.gsap.timeline({paused:!0}).add(()=>{e.style.display="flex",[s,r,l].forEach(p=>{p.style.display="none"})},"openMainMenu").add(()=>{e.style.display="none",s.style.display="flex"},"openParcMenu").add(()=>{e.style.display="none",r.style.display="flex"},"openActiviteMenu").add(()=>{e.style.display="none",l.style.display="flex"},"openOffresMenu")}C=L();function T(p=null){[n,i,a,document.querySelector("#parcs-nav_button"),document.querySelector("#activites-nav_button"),document.querySelector("#formules-nav_button")].forEach(w=>{w&&(p&&w.id===p?w.classList.add("active"):w.classList.remove("active"))})}function m(p){p?q.play():q.reverse()}function f(p){const w={"parcs-nav_button":s,"activites-nav_button":r,"formules-nav_button":l,"parcs-nav_button_mobile":s,"activites-nav_button_mobile":r,"formules-nav_button_mobile":l}[p];if(w){if(e.style.display="none",s.style.display="none",r.style.display="none",l.style.display="none",c&&w.style.display==="flex"){c=!1,_(),T(),m(!1);return}requestAnimationFrame(()=>{w.style.display="flex",c=!0,E(),T(p),m(!0)})}}function y(){C&&C.kill(),c=!1,[e,s,r,l].forEach(p=>{p.style.display="none"}),_(),T(),m(!1),C=L()}function P(){[s,r,l].forEach(p=>{p.style.display="none"}),e.style.display="flex",c=!0}function x(p){e.style.display="none",c=!0,p.style.display="flex"}t.addEventListener("click",()=>{c?y():([s,r,l].forEach(p=>{p.style.display="none"}),e.style.display="flex",c=!0,E(),m(!0))}),n.addEventListener("click",()=>x(s)),i.addEventListener("click",()=>x(r)),a.addEventListener("click",()=>x(l)),d.forEach(p=>{p.addEventListener("click",y)}),u.forEach(p=>{p.addEventListener("click",P)}),document.querySelectorAll("#parcs-nav_button, #activites-nav_button, #formules-nav_button, #parcs-nav_button_mobile, #activites-nav_button_mobile, #formules-nav_button_mobile").forEach(p=>{p.addEventListener("click",W=>{W.preventDefault(),f(p.id)})})}console.log("🚀 centre-card.js v6.1.0 chargé");const g={CARD:".centre-card_wrapper.effect-cartoon-shadow",CLICKABLE_WRAP:'.clickable_wrap[data-attribute="data-card-toggle"]',TOGGLE_ELEMENTS:[".centre-card_scroll_wrapper",".centre-card_list",".centre-card_button-holder",".tag_holder_wrapper"],ARROW:".svg-holder.arrow",INTERNAL_LINKS:".centre-card_button-holder a, .centre-card_button-holder button"},j=new WeakSet;let $=!1;async function O(t){if(!t||!t.classList.contains("is-open"))return;const e=t.querySelectorAll(g.TOGGLE_ELEMENTS.join(",")),o=t.querySelector(g.ARROW),n=t.querySelector(".centre-card_scroll_wrapper");t.classList.remove("is-open");const i=window.gsap.timeline({onStart:()=>{n&&window.gsap.set(n,{height:"10rem"})},onComplete:()=>{window.gsap.set(e,{display:"none"}),n&&window.gsap.set(n,{height:0})}});i.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in",stagger:{each:.02,from:"start"}},0),o&&i.to(o,{rotation:0,duration:.25,ease:"power2.inOut"},0),n&&i.to(n,{height:0,duration:.4,ease:"back.in(1.7)"},0),await i}async function B(t){if(!t||t.classList.contains("is-open"))return;t.classList.add("is-open");const e=t.querySelectorAll(g.TOGGLE_ELEMENTS.join(",")),o=t.querySelector(g.ARROW),n=t.querySelector(".centre-card_scroll_wrapper");e.forEach(a=>{window.gsap.set(a,{display:a.dataset.originalDisplay||"block",opacity:0,y:-20})});const i=window.gsap.timeline({onStart:()=>{n&&window.gsap.set(n,{height:0})}});n&&i.to(n,{height:"10rem",duration:.6,ease:"elastic.out(1.2, 0.5)"},0),o&&i.to(o,{rotation:90,duration:.25,ease:"back.out(1.7)"},"<"),i.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out",stagger:{each:.035,from:"start"}},"<0.05"),await i}async function se(t){var e;if(!$){$=!0;try{if(t.classList.contains("is-open"))await O(t),document.dispatchEvent(new CustomEvent("map:reset")),console.log("🗺️ Événement map:reset émis");else{const n=document.querySelectorAll(`${g.CARD}.is-open`);await Promise.all(Array.from(n).map(a=>O(a))),await B(t);const i=(e=t.closest(".w-dyn-item"))==null?void 0:e.dataset.placeId;i&&(document.dispatchEvent(new CustomEvent("map:focus",{detail:{placeId:i}})),console.log("📍 Événement map:focus émis pour:",i))}}finally{$=!1}}}function F(t){var i,a;if(!t||j.has(t)){console.log("⏭️ Carte déjà initialisée, ignorée");return}console.log("🔧 Initialisation de la carte:",t);let e=(i=t.parentElement)==null?void 0:i.querySelector(g.CLICKABLE_WRAP);if(e||(e=(a=t.parentElement)==null?void 0:a.querySelector(".clickable_wrap"),e&&console.log("✅ Clickable wrap trouvé sans attribut data-card-toggle")),!e){console.log("❌ Clickable wrap non trouvé pour la carte:",t);return}const o=t.querySelectorAll(g.TOGGLE_ELEMENTS.join(","));console.log(`📋 Éléments à basculer trouvés: ${o.length}`),o.forEach(s=>{const r=window.getComputedStyle(s);s.dataset.originalDisplay=r.display,console.log(`💾 Display original sauvé pour ${s.className}: ${r.display}`)}),window.gsap.set(o,{display:"none",opacity:0,y:-20}),console.log("🔒 Carte fermée par défaut");const n=s=>{if(s.target.closest(g.INTERNAL_LINKS)){console.log("🔗 Clic sur lien interne, toggle ignoré");return}s.preventDefault(),s.stopPropagation(),console.log("👆 Clic sur carte détecté"),se(t)};e.addEventListener("click",n),j.add(t),console.log("✅ Carte initialisée avec succès")}function ae(){const t=document.querySelector(".collection-list-centre-wrapper");if(!t)return;new MutationObserver(o=>{for(const n of o)n.type==="childList"&&n.addedNodes.forEach(i=>{i.nodeType===1&&(i.matches(g.CARD)&&F(i),i.querySelectorAll(g.CARD).forEach(a=>F(a)))})}).observe(t,{childList:!0,subtree:!0})}function re(t){if(!t)return null;const e=document.querySelectorAll(".w-dyn-item");for(const o of e){const n=o.querySelector(g.CARD);if(!n)continue;if(o.querySelectorAll('a[href*="/nos-parcs-a-paris-region-parisienne/'+t+'"]').length>0)return n}return null}function le(){console.log("🎯 Configuration de l'écoute du menu Parcs..."),document.addEventListener("click",t=>{const e=t.target.closest('a[href*="/nos-parcs-a-paris-region-parisienne/"]');if(!e||!window.location.pathname.includes("/activites-par-centre/"))return;const n=e.getAttribute("href").split("/nos-parcs-a-paris-region-parisienne/")[1];console.log("🖱️ Clic détecté sur lien centre:",n),setTimeout(()=>{const i=re(n);i?(console.log("✅ Carte trouvée pour le centre cliqué, ouverture..."),document.querySelectorAll(`${g.CARD}.is-open`).forEach(s=>{s!==i&&O(s)}),i.classList.contains("is-open")||B(i)):console.log("❌ Aucune carte trouvée pour le centre:",n)},300)}),console.log("✅ Écoute du menu Parcs configurée")}function ce(){if(console.log("🚀 === INITIALISATION DES CARTES DE CENTRE ==="),console.log("📍 Page actuelle:",window.location.pathname),console.log("🏗️ DOM ready state:",document.readyState),!window.gsap){console.log("❌ GSAP non disponible, initialisation annulée");return}let t=document.querySelectorAll(g.CARD);if(t.length===0){console.log("⚠️ Aucune carte trouvée avec le sélecteur principal. Tentative avec sélecteurs alternatifs...");const e=[".centre-card_wrapper",'[class*="centre-card"]',".card-centre_wrapper"];for(const o of e)if(t=document.querySelectorAll(o),t.length>0){console.log(`✅ Cartes trouvées avec sélecteur alternatif: ${o} (${t.length} éléments)`);break}}if(console.log(`📊 ${t.length} cartes trouvées au total`),t.length===0){console.log("❌ Aucune carte trouvée, initialisation annulée");return}t.forEach(e=>{e.classList.contains("is-open")&&(console.log("🔒 Fermeture forcée de carte ouverte au démarrage"),e.classList.remove("is-open"))}),t.forEach((e,o)=>{console.log(`🔧 Initialisation carte ${o+1}/${t.length}`),F(e)}),ae(),le(),console.log("✅ === INITIALISATION TERMINÉE ===")}function de(){console.group("--- Informations de Débogage ---"),console.log("Wrapper Menu Desktop:",document.querySelector(".desktop_menu_wrapper")),console.log("Boutons de menu:",{parcs:document.querySelector('[data-attribute="nav-link-desktop-parcs"]'),activites:document.querySelector('[data-attribute="nav-link-desktop-activites"]'),offres:document.querySelector('[data-attribute="nav-link-desktop-offres"]')}),console.log("Conteneurs de menu:",{parcs:document.querySelector(".parc_menu_desktop"),activites:document.querySelector(".activites_menu_desktop"),offres:document.querySelector(".offres_menu_desktop")}),console.groupEnd()}function ue(){window.location.hash==="#debug"&&(console.log("🐛 Mode de débogage activé."),de())}(function(){if(!window.location.pathname.includes("/reservation"))return;const t="https://www.apex-timing.com/gokarts/sessions_booking.php?center=",e='[data-attribute="parc-item"]',o=window.matchMedia("(prefers-reduced-motion: reduce)").matches,n=`
  :root { --booking-bar-h: 56px; }

  #booking_overlay {
    position: fixed; inset: 0;
    width: 100vw; height: 100vh;
    z-index: 9999; background: #0c0c0f;
    display: none; opacity: 0;
    pointer-events: none;
    overscroll-behavior: contain; /* bloque la propagation du scroll vers le body */
    touch-action: pan-y; /* améliore le geste de scroll vertical mobile */
  }
  #booking_overlay.is-open {
    display: block;
    pointer-events: auto; /* bloque bien les clics derrière */
  }
  #booking_overlay.is-visible {
    opacity: 1;
    transition: opacity 220ms ease;
  }

  .booking-bar {
    position: absolute; top: 0; left: 0; right: 0;
    display: flex; align-items: center; gap: 12px;
    padding: 10px 16px; background: #111; color: #fff;
    border-bottom: 1px solid rgba(255,255,255,.12);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  }
  .booking-bar__btn {
    background: #ffc31f; color: #000; font-weight: 700;
    border: 0; border-radius: 13px; padding: 10px 16px; cursor: pointer;
  }
  .booking-bar__title { font-weight: 700; opacity: .9; }

  .booking-panel {
    position: absolute; left: 0; right: 0;
    top: var(--booking-bar-h);
    height: calc(100% - var(--booking-bar-h));
    transform: scale(.985); opacity: 0;
    overflow-y: auto; /* permet de scroller le contenu (iframe) */
    -webkit-overflow-scrolling: touch; /* inertie iOS */
    touch-action: pan-y;
  }
  .booking-panel.is-in {
    transform: scale(1); opacity: 1;
    transition: transform 320ms cubic-bezier(.2,.7,0,1), opacity 260ms ease;
  }

  #booking_iframe {
    position: absolute; inset: 0; width: 100%; height: 100%;
    border: 0; background: #fff;
    /* s'assure que l'iframe capte bien les interactions */
    pointer-events: auto;
  }

  @media (max-width: 767px) {
    .booking-bar { flex-direction: column; align-items: stretch; gap: 8px; padding: 12px; }
    .booking-bar__btn { width: 100%; }
    .booking-bar__title { text-align: center; }
  }

  @media (prefers-reduced-motion: reduce) {
    #booking_overlay.is-visible { transition: none; }
    .booking-panel.is-in { transition: none; }
  }`,i=document.createElement("style");i.textContent=n,document.head.appendChild(i);const a="https://www.apex-timing.com/gokarts/javascript/ax.iframe.js";(function(){try{if(!document.querySelector('script[src*="apex-timing.com/gokarts/javascript/ax.iframe.js"]')){const f=document.createElement("script");f.src=a,f.async=!0,document.head.appendChild(f)}}catch{}})();const s=document.createElement("div");s.id="booking_overlay";const r=document.createElement("div");r.className="booking-bar";const l=document.createElement("button");l.className="booking-bar__btn",l.textContent="← Changer de centre";const d=document.createElement("div");d.className="booking-bar__title",d.textContent="Réservation",r.appendChild(l),r.appendChild(d);const u=document.createElement("div");u.className="booking-panel";const c=document.createElement("iframe");c.id="booking_iframe",c.title="Réservation",c.loading="lazy",c.referrerPolicy="no-referrer-when-downgrade",c.classList.add("axiframe"),c.setAttribute("scrolling","yes"),u.appendChild(c),s.appendChild(r),s.appendChild(u),document.body.appendChild(s);let h=0;function C(){try{h=window.scrollY||document.documentElement.scrollTop||0,document.body.style.position="fixed",document.body.style.top=`-${h}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.width="100%"}catch{}}function q(){try{document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.width="",window.scrollTo(0,h||0)}catch{}}function E(){const m=Math.ceil(r.getBoundingClientRect().height||56);s.style.setProperty("--booking-bar-h",m+"px")}function _(){s.classList.add("is-open"),E(),o?(s.classList.add("is-visible"),u.classList.add("is-in")):requestAnimationFrame(()=>{s.classList.add("is-visible"),requestAnimationFrame(()=>u.classList.add("is-in"))}),C()}function L(){u.classList.remove("is-in"),s.classList.remove("is-visible");const m=()=>{s.classList.remove("is-open"),s.removeEventListener("transitionend",f)},f=y=>{y.target===s&&y.propertyName==="opacity"&&m()};o?m():(s.addEventListener("transitionend",f),setTimeout(m,350)),q()}l.addEventListener("click",L),document.addEventListener("keydown",m=>{m.key==="Escape"&&s.classList.contains("is-open")&&L()}),document.addEventListener("click",m=>{var p;const f=m.target.closest(e);if(!f)return;const y=f.getAttribute("data-apex-id"),P=f.getAttribute("data-centre-name")||(((p=f.querySelector(".h6, h3, .centre_card_title"))==null?void 0:p.textContent)||"").trim();if(!/^\d{3}$/.test(y))return;const x=t+y;c.setAttribute("data-src",x),c.src=x,d.textContent=P?`Réservation · ${P}`:"Réservation",_()}),new ResizeObserver(E).observe(r),window.addEventListener("resize",E);try{const f=new URLSearchParams(window.location.search).get("parc");if(f&&/^\d{3}$/.test(f)){const y=t+f;c.setAttribute("data-src",y),c.src=y,d.textContent="Réservation",_()}}catch{}})(),console.log("🗺️ map-integration.js v2.1.2 chargé");const M={map:null,markers:[],infoWindow:null,bottomSheetElement:null,initialCenter:{lat:48.82,lng:2.25},initialZoom:10,initMap:function(){const t=document.getElementById("map");if(!t){console.error("Erreur : L'élément #map est introuvable dans le DOM.");return}const e=t.dataset.mapId;e||console.warn("⚠️ data-map-id n'est pas défini sur l'élément #map. Les marqueurs avancés pourraient ne pas fonctionner."),this.map=new google.maps.Map(t,{center:this.initialCenter,zoom:this.initialZoom,disableDefaultUI:!0,zoomControl:!0,mapId:e}),this.infoWindow=new google.maps.InfoWindow,google.maps.event.addListener(this.infoWindow,"closeclick",()=>{this.resetMapView()}),this.injectBottomSheet(),this.createMarkers()},injectBottomSheet:function(){const t=document.createElement("style");t.textContent=`
            .map-bottom-sheet {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background-color: white;
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
                box-shadow: 0 -4px 12px rgba(0,0,0,0.1);
                transform: translateY(100%);
                transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
                z-index: 1000;
                max-height: 85vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                visibility: hidden;
            }
            .map-bottom-sheet.is-visible {
                transform: translateY(0);
                visibility: visible;
            }
            .map-bottom-sheet__content {
                padding: 24px;
                padding-top: 50px;
            }
            .map-bottom-sheet__close-btn {
                position: absolute;
                top: 12px;
                right: 12px;
                background: #f0f0f0;
                border: none;
                border-radius: 50%;
                width: 32px;
                height: 32px;
                font-size: 22px;
                line-height: 32px;
                text-align: center;
                cursor: pointer;
                font-weight: bold;
                color: #333;
                z-index: 2;
            }
            .map-bottom-sheet__handle {
                position: absolute;
                top: 8px;
                left: 50%;
                transform: translateX(-50%);
                width: 40px;
                height: 4px;
                background-color: #ccc;
                border-radius: 2px;
            }
        `,document.head.appendChild(t),document.body.insertAdjacentHTML("beforeend",`
            <div id="map-bottom-sheet" class="map-bottom-sheet" aria-hidden="true">
                <div class="map-bottom-sheet__handle"></div>
                <button class="map-bottom-sheet__close-btn" aria-label="Fermer">&times;</button>
                <div class="map-bottom-sheet__content"></div>
            </div>
        `),this.bottomSheetElement=document.getElementById("map-bottom-sheet"),this.bottomSheetElement.querySelector(".map-bottom-sheet__close-btn").addEventListener("click",()=>{this.hideBottomSheet()})},createMarkers:function(){const t=document.querySelectorAll(".w-dyn-item[data-place-id]");console.log(`📍 ${t.length} cartes trouvées pour la création des marqueurs.`),t.forEach(e=>{var l,d;const o=parseFloat(e.dataset.lat),n=parseFloat(e.dataset.lng),i=e.dataset.placeId,a=e.dataset.centreUrl||null;let s=null;try{if(a){let u=a.trim();const c="/nos-parcs-a-paris-region-parisienne/";/^https?:\/\//i.test(u)?s=u:u.startsWith(c)?s=new URL(u,window.location.origin).href:u.startsWith("/")?s=new URL(c+u.replace(/^\/+/,""),window.location.origin).href:s=new URL(c+u,window.location.origin).href}else console.warn("Aucune URL de centre fournie (data-centre-url manquant) pour:",e)}catch{console.warn('URL de centre invalide détectée dans data-centre-url, le bouton "Voir le centre" sera masqué.',a)}if(isNaN(o)||isNaN(n)||!i){const u=((l=e.querySelector("h3"))==null?void 0:l.textContent)||"Nom non trouvé";console.warn(`⚠️ Carte ignorée (nom: "${u}") car ses données de latitude/longitude sont manquantes ou invalides.`,e);return}const r=new google.maps.marker.AdvancedMarkerElement({map:this.map,position:{lat:o,lng:n},title:((d=e.querySelector("h3"))==null?void 0:d.textContent)||"Centre Smile World"});r.addListener("click",()=>{window.matchMedia("(max-width: 768px)").matches?this.showBottomSheetForPlace(i):this.focusOnCenter(i,r)}),this.markers.push({placeId:i,marker:r,centreUrl:s})})},focusOnCenter:async function(t,e){var o;if(!(!t||!this.map)){console.log(`🔎 Zoom sur le centre avec Place ID : ${t}`);try{const{Place:n}=await google.maps.importLibrary("places"),i=new n({id:t}),a=["displayName","formattedAddress","location","rating","googleMapsURI","photos","userRatingCount","regularOpeningHours"];if(await i.fetchFields({fields:a}),i.location){this.map.panTo(i.location),this.map.setZoom(15);const s=this.markers.find(d=>d.placeId===t),r=this.buildInfoWindowContent(i,!1,s==null?void 0:s.centreUrl);this.infoWindow.setContent(r);const l=e||((o=this.markers.find(d=>d.placeId===t))==null?void 0:o.marker);l&&this.infoWindow.open(this.map,l)}else console.error(`Aucune donnée de localisation trouvée pour le Place ID ${t}`)}catch(n){console.error(`Erreur lors de la récupération des détails pour le Place ID ${t}:`,n)}}},showBottomSheetForPlace:async function(t){if(!(!t||!this.map)){console.log(`📱 Affichage du panneau mobile pour Place ID : ${t}`);try{const{Place:e}=await google.maps.importLibrary("places"),o=new e({id:t}),n=["displayName","formattedAddress","location","rating","googleMapsURI","photos","userRatingCount","regularOpeningHours"];if(await o.fetchFields({fields:n}),o.location){this.map.panTo(o.location),this.map.setZoom(15);const i=this.markers.find(s=>s.placeId===t),a=this.buildInfoWindowContent(o,!0,i==null?void 0:i.centreUrl);this.bottomSheetElement.querySelector(".map-bottom-sheet__content").innerHTML=a,this.bottomSheetElement.classList.add("is-visible"),this.bottomSheetElement.setAttribute("aria-hidden","false")}else console.error(`Aucune donnée de localisation trouvée pour le Place ID ${t}`)}catch(e){console.error(`Erreur lors de la récupération des détails pour le Place ID ${t}:`,e)}}},hideBottomSheet:function(){!this.bottomSheetElement||!this.map||(this.bottomSheetElement.classList.remove("is-visible"),this.bottomSheetElement.setAttribute("aria-hidden","true"),console.log("🔙 Réinitialisation de la vue de la carte..."),this.map.panTo(this.initialCenter),this.map.setZoom(this.initialZoom))},buildInfoWindowContent:function(t,e=!1,o=null){let n="";t.photos&&t.photos.length>0&&(n=`<img src="${t.photos[0].getURI({maxWidth:400,maxHeight:200})}" alt="Photo de ${t.displayName}" style="width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;">`);let i="";t.rating&&(i=`
                <div style="display: flex; align-items: center; color: #555; margin-bottom: 8px; font-size: 14px;">
                    <span style="color: #f8b400; font-size: 18px; margin-right: 8px;">${"★".repeat(Math.round(t.rating))+"☆".repeat(5-Math.round(t.rating))}</span>
                    <span style="font-weight: bold; color: #111; margin-right: 5px;">${t.rating.toFixed(1)}</span>
                    <span>(${t.userRatingCount||0} avis)</span>
                </div>`);let a="",s="";if(t.regularOpeningHours&&t.regularOpeningHours.weekdayDescriptions){const u=new Date().getDay(),c=u===0?6:u-1;s=`<div style="font-size: 13px; color: #333; margin-bottom: 12px; display: flex; align-items: center;"><svg viewBox="0 0 24 24" style="width:16px; height:16px; margin-right: 8px; fill: #555;"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6h6v-2h-4V7z"></path></svg><span>${t.regularOpeningHours.weekdayDescriptions[c]}</span></div>`}const r=`font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; ${e?"":"max-width: 290px;"} padding: 5px;`,l=o?`<a href="${o}" style="display: inline-block; margin-top: 8px; margin-right: 8px; font-size: 13px; color: white; background-color: #1a73e8; text-decoration: none; font-weight: 600; padding: 8px 10px; border-radius: 6px;">Voir le centre</a>`:"",d=`<a href="${t.googleMapsURI}" target="_blank" style="display: inline-block; margin-top: 8px; font-size: 13px; color: #1a73e8; text-decoration: none; font-weight: 500;">Voir sur Google Maps</a>`;return`
            <div style="${r}">
                ${n}
                <div style="font-size: 18px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px;">${t.displayName}</div>
                <div style="font-size: 13px; color: #555; margin-bottom: 8px;">${t.formattedAddress}</div>
                ${i}
                ${s}
                ${l}${d}
                ${a}
            </div>
        `},resetMapView:function(){this.map&&(console.log("🔄 Réinitialisation de la vue de la carte."),this.infoWindow.close(),this.hideBottomSheet(),this.map.panTo(this.initialCenter),this.map.setZoom(this.initialZoom))}};window.initGoogleMap=M.initMap.bind(M),window.mapManager=M;function pe(){const t=document.getElementById("map");if(!t)return;const e=t.dataset.apiKey;if(!e){console.error(`❌ Clé API Google Maps manquante. Veuillez l'ajouter dans l'attribut "data-api-key" de la div #map.`);return}if(window.google&&window.google.maps){console.log("🗺️ Google Maps API déjà chargée."),M.initMap();return}console.log("🗺️ Chargement de l'API Google Maps...");const o=document.createElement("script");o.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places,marker&callback=initGoogleMap&loading=async&language=fr`,o.async=!0,document.head.appendChild(o)}console.log("🔗 preselect.js prêt à être initialisé");function me(){const t="[SW-PRESELECT]",e=(...s)=>console.log(new Date().toLocaleTimeString(),t,...s),o="/reservation",n=document.querySelector("[data-preselect-activity-slug], [data-preselect-park-id]");if(!n){console.warn(t,"Aucun élément wrapper avec [data-preselect-activity-slug] ou [data-preselect-park-id] trouvé.");return}const i=document.querySelectorAll('[data-attribute="preselect-booking-button"]');console.log("✅ Module de présélection initialisé.");const a=n.dataset.preselectParkId;if(a){const s=`${o}?parc=${encodeURIComponent(a)}`;i.forEach(r=>{r.href=s,r.addEventListener("click",function(l){l.preventDefault(),l.stopPropagation(),window.location.href=s},!0)}),e(`Liens de réservation mis à jour (centre uniquement) -> ${s}`)}}const fe=()=>{const t=document.querySelector(".desktop_menu_content.right .w-dyn-items"),e=document.querySelectorAll(".desktop_menu_list.acitivt-s .default-container");if(!t||!e.length)return;const o=Array.from(t.children).find(r=>{const l=r.querySelector("img");return l&&l.id==="Bowling"});Array.from(t.children).forEach(r=>{r===o?(r.style.opacity="1",r.style.display="block"):(r.style.opacity="0",r.style.display="none")});const n=new Map;let i=null;const a=(r,l)=>{const d=Array.from(t.children).find(u=>{const c=u.querySelector("img");return c&&c.id===r});if(d)if(n.has(d)&&(n.get(d).kill(),n.delete(d)),l){if(i=r,o&&o!==d){n.has(o)&&n.get(o).kill();const c=window.gsap.to(o,{opacity:0,duration:.15,ease:"power2.out",onComplete:()=>{o&&(o.style.display="none"),n.delete(o)}});n.set(o,c)}d.style.display="block";const u=window.gsap.to(d,{opacity:1,duration:.15,ease:"power2.out",onComplete:()=>n.delete(d)});n.set(d,u)}else{i===r&&(i=null);const u=window.gsap.to(d,{opacity:0,duration:.15,ease:"power2.out",onComplete:()=>{if(d.style.display="none",i===null&&o){o.style.display="block",n.has(o)&&n.get(o).kill();const c=window.gsap.to(o,{opacity:1,duration:.15,ease:"power2.out",onComplete:()=>n.delete(o)});n.set(o,c)}n.delete(d)}});n.set(d,u)}},s=(r,l)=>{n.has(r)&&(n.get(r).kill(),n.delete(r));const d={duration:l?.1:.05,ease:"power2.out",onComplete:()=>n.delete(r)},u=l?{scale:1.1,backgroundColor:"#FFFFFF"}:{scale:1,backgroundColor:""},c=window.gsap.to(r,{...u,...d});n.set(r,c)};e.forEach(r=>{const l=r.getAttribute("data-name");l&&(r.addEventListener("mouseenter",()=>{a(l,!0),s(r,!0)}),r.addEventListener("mouseleave",()=>{a(l,!1),s(r,!1)}))})};function ge(){console.log("🔧 Configuration du gestionnaire de filtres vides v2.1.0..."),window.fsAttributes||(window.fsAttributes=[]),window.fsAttributes.push(["list",t=>{console.log("✅ Finsweet list callback déclenché!",t.length,"instances"),he()}]),console.log("📋 Callback Finsweet configuré correctement avec fsAttributes")}function he(){console.log("🎯 Configuration des filtres vides...");const t=document.querySelectorAll("input[fs-list-field]");console.log(`📊 ${t.length} inputs fs-list-field trouvés`),t.forEach((e,o)=>{if(e.closest(".is-list-emptyfacet")){console.log(`🔒 Input ${o+1} dans empty facet - désactivation`),e.style.cursor="default";const i=e.closest("label");i&&(i.style.cursor="default")}e.addEventListener("click",i=>{if(e.closest(".is-list-emptyfacet")){console.log("🚫 Clic bloqué sur filtre vide"),i.preventDefault(),i.stopPropagation();return}}),e.addEventListener("change",()=>{var s;if(e.closest(".is-list-emptyfacet"))return;const a=(s=e.closest(".tag_wrap"))==null?void 0:s.querySelector(".tags_content");a&&(e.checked?a.classList.add("is-active"):a.classList.remove("is-active"))})}),console.log("🎯 Filtres vides configurés avec succès")}class G{constructor(){this.version="1.2.1",this.initialized=!1,this.selectors={collectionList:'[fs-list-element="list"]',collectionItems:'[fs-list-element="item"]',filterInputs:"input[fs-list-field]",noItemsMessage:".w-dyn-empty",filterForms:'[fs-list-element="filters"]',cmsSlider:"#cms-slider-offres",helperText:"#helper-text"},this.messages={selectFilter:"👆 Sélectionnez un parc ou un type d'offre pour voir nos offres disponibles",noResults:"Aucune offre ne correspond à vos critères. Essayez une autre sélection."}}init(){const e=window.location.pathname;if(!["/offres","/anniversaires","/tarifs-generaux"].includes(e)){console.log(`🚫 mandatory-filter-selection.js - Page ${e} non concernée`);return}if(this.initialized){console.log("⚠️ mandatory-filter-selection.js déjà initialisé");return}console.log(`🎯 mandatory-filter-selection.js v${this.version} - Initialisation sur ${e}`),this.setupInitialState(),this.bindEvents(),this.initialized=!0,console.log("✅ Filtrage obligatoire activé - Sélectionnez un filtre pour voir les offres")}setupInitialState(){const e=document.querySelector(this.selectors.collectionList),o=document.querySelectorAll(this.selectors.collectionItems);if(!e){console.log("❌ Collection list non trouvée");return}o.forEach(n=>{n.style.display="none"}),this.showSelectionMessage(),this.hideCmsSlider(),this.showHelperText(),console.log(`🔒 ${o.length} offres cachées - En attente de sélection de filtre`)}showSelectionMessage(){const e=document.querySelector(this.selectors.collectionList);if(!e)return;const o=e.querySelector(".mandatory-filter-message");o&&o.remove();const n=document.createElement("div");if(n.className="mandatory-filter-message",n.style.cssText=`
            padding: 40px 20px;
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            margin: 20px 0;
            color: white;
            font-size: 18px;
            font-weight: 500;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
            animation: pulse 2s infinite;
        `,n.innerHTML=`
            <div style="font-size: 48px; margin-bottom: 16px;">🎯</div>
            <div>${this.messages.selectFilter}</div>
        `,!document.querySelector("#mandatory-filter-styles")){const i=document.createElement("style");i.id="mandatory-filter-styles",i.textContent=`
                @keyframes pulse {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.02); opacity: 0.9; }
                }
                .mandatory-filter-message {
                    transition: all 0.3s ease;
                }
            `,document.head.appendChild(i)}e.appendChild(n)}bindEvents(){const e=document.querySelectorAll(this.selectors.filterInputs);e.forEach(o=>{o.addEventListener("change",()=>{this.handleFilterChange()})}),window.addEventListener("list-updated",()=>{this.handleListUpdate()}),console.log(`🔗 ${e.length} filtres écoutés`)}handleFilterChange(){const e=document.querySelectorAll(`${this.selectors.filterInputs}:checked`);e.length>0?(console.log(`✅ ${e.length} filtre(s) sélectionné(s) - Affichage des offres`),this.showCollectionItems(),this.hideSelectionMessage(),this.showCmsSlider(),this.hideHelperText()):(console.log("🔒 Aucun filtre sélectionné - Masquage des offres"),this.hideCollectionItems(),this.showSelectionMessage(),this.hideCmsSlider(),this.showHelperText())}handleListUpdate(){const e=document.querySelectorAll(`${this.selectors.filterInputs}:checked`),o=document.querySelectorAll(`${this.selectors.collectionItems}:not([style*="display: none"])`);e.length>0&&o.length===0&&(console.log("⚠️ Aucun résultat pour les filtres sélectionnés"),this.showNoResultsMessage())}showCollectionItems(){document.querySelectorAll(this.selectors.collectionItems).forEach(o=>{o.style.display=""})}hideCollectionItems(){document.querySelectorAll(this.selectors.collectionItems).forEach(o=>{o.style.display="none"})}hideSelectionMessage(){const e=document.querySelector(".mandatory-filter-message");e&&(e.style.display="none")}showCmsSlider(){const e=document.querySelector(this.selectors.cmsSlider);e&&(e.style.display="",console.log("👁️ Slider CMS des offres affiché (filtre sélectionné)"))}hideCmsSlider(){const e=document.querySelector(this.selectors.cmsSlider);e&&(e.style.display="none",console.log("🙈 Slider CMS des offres masqué (aucun filtre)"))}showHelperText(){const e=document.querySelector(this.selectors.helperText);e&&(e.style.display="",console.log("👁️ Texte d'aide affiché (aucun filtre)"))}hideHelperText(){const e=document.querySelector(this.selectors.helperText);e&&(e.style.display="none",console.log("🙈 Texte d'aide masqué (filtre sélectionné)"))}showNoResultsMessage(){const e=document.querySelector(this.selectors.collectionList);if(!e||e.querySelector(".no-results-message"))return;const n=document.createElement("div");n.className="no-results-message",n.style.cssText=`
            padding: 30px 20px;
            text-align: center;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
            color: #6c757d;
            font-size: 16px;
        `,n.innerHTML=`
            <div style="font-size: 32px; margin-bottom: 12px;">😕</div>
            <div>${this.messages.noResults}</div>
        `,e.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},3e3)}reset(){this.hideSelectionMessage(),this.showCollectionItems(),this.hideCmsSlider(),this.showHelperText(),this.initialized=!1,console.log("🔄 Filtrage obligatoire réinitialisé")}}window.mandatoryFilterSelection=new G,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{window.mandatoryFilterSelection.init()}):window.mandatoryFilterSelection.init(),console.log("🚀 mandatory-filter-selection.js v1.2.1 chargé");class U{constructor(){this.version="1.6.0",this.initialized=!1,this.selectors={formWrapper:"#devis-form-wrapper",filterElements:"[fs-list-value]",filterForms:'[fs-list-element="filters"]',mapElement:"#map"}}init(){const e=window.location.pathname;if(!["/smile-event-solutions-entreprises"].includes(e)){console.log(`🚫 event-form-visibility.js - Page ${e} non concernée`);return}if(this.initialized){console.log("⚠️ event-form-visibility.js déjà initialisé");return}console.log(`🎯 event-form-visibility.js v${this.version} - Initialisation sur ${e}`),this.setupInitialState(),this.bindEvents(),this.setupMapData(),this.initialized=!0,console.log("✅ Logique d'affichage du formulaire de devis activée")}setupInitialState(){const e=document.querySelector(this.selectors.formWrapper);if(!e){console.log("❌ Conteneur du formulaire de devis non trouvé");return}e.style.display="none",console.log("🔒 Formulaire de devis caché - En attente de sélection de centre")}setupMapData(){if(!document.querySelector(this.selectors.mapElement)){console.log("ℹ️ Aucun élément #map trouvé, pas d'initialisation de carte");return}const o=document.querySelector("select[fs-list-field]");if(!o){console.log("❌ Dropdown des centres non trouvé pour récupérer les données de la carte");return}const n=document.createElement("div");n.id="centres-data-container",n.style.display="none",document.body.appendChild(n);let i=0;Array.from(o.options).forEach((a,s)=>{if(s===0||!a.value)return;const r=a.dataset.placeId,l=a.dataset.lat,d=a.dataset.lng,u=a.textContent.trim();if(r&&l&&d){const c=document.createElement("div");c.className="w-dyn-item",c.setAttribute("data-place-id",r),c.setAttribute("data-lat",l),c.setAttribute("data-lng",d);const h=document.createElement("h3");h.textContent=u,c.appendChild(h),n.appendChild(c),i++}else console.warn(`⚠️ Données manquantes pour le centre "${u}". Vérifiez les attributs data-place-id, data-lat, data-lng sur l'option du dropdown.`)}),i>0?(console.log(`🗺️ ${i} centres configurés pour la carte Google Maps`),window.mapManager&&window.mapManager.createMarkers()):console.log("⚠️ Aucune donnée de centre trouvée pour la carte. Ajoutez les attributs data-place-id, data-lat, data-lng aux options du dropdown côté Webflow.")}bindEvents(){const e=document.querySelectorAll(this.selectors.filterElements);e.forEach(o=>{o.addEventListener("change",()=>{this.handleFilterChange()}),o.addEventListener("click",()=>{this.handleFilterChange()})}),window.addEventListener("list-updated",()=>{this.handleFilterChange()}),console.log(`🔗 ${e.length} élément(s) de filtre écouté(s)`)}handleFilterChange(){const e=document.querySelectorAll(this.selectors.filterElements);let o=!1;e.forEach(n=>{if(n.checked||n.classList.contains("w--current")||n.tagName.toLowerCase()==="select"&&n.value&&n.value!==""){const i=n.getAttribute("fs-list-value");i&&(o=!0,console.log(`🎯 Filtre actif détecté: ${i}`))}}),o?(console.log("✅ Centre sélectionné - Affichage du formulaire de devis"),this.showFormWrapper()):(console.log("🔒 Aucun centre sélectionné - Masquage du formulaire de devis"),this.hideFormWrapper())}showFormWrapper(){const e=document.querySelector(this.selectors.formWrapper);e&&(e.style.display="")}hideFormWrapper(){const e=document.querySelector(this.selectors.formWrapper);e&&(e.style.display="none")}reset(){this.hideFormWrapper();const e=document.getElementById("centres-data-container");e&&e.remove(),this.initialized=!1,console.log("🔄 Logique du formulaire de devis réinitialisée")}}window.eventFormVisibility=new U,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{window.eventFormVisibility.init()}):window.eventFormVisibility.init(),console.log("🚀 event-form-visibility.js v1.6.0 chargé"),console.log("🎠 marquee-animation.js v1.4.1 chargé");let S=null,I=new WeakMap;function ye(){console.log("🎬 Initialisation de l'animation marquee...");const t=document.querySelector(".cms_slider_wrapper");if(!t){console.log("-> Aucun élément .cms_slider_wrapper trouvé. Animation marquee ignorée.");return}V(),we(t)}function V(){console.log("⚙️ Configuration des états initiaux..."),document.querySelectorAll(".vimeo.activity").forEach(o=>{o.style.display="none",o.style.opacity="0"}),document.querySelectorAll("#titre-original").forEach(o=>{o.style.opacity="1",o.style.visibility="visible",o.dataset.originalColor||(o.dataset.originalColor=window.getComputedStyle(o).color)})}function we(t){if(console.log("🏃‍♂️ Création de l'effet marquee..."),t.children.length===0){console.warn("-> Aucun élément enfant trouvé dans .cms_slider_wrapper");return}const o=window.matchMedia("(pointer:coarse)").matches||window.innerWidth<=768;o&&console.log("📱 Mobile détecté : on conserve la structure marquee mais on met la timeline en pause pour permettre le drag natif."),t.style.overflow=o?"auto":"hidden",t.style.whiteSpace="nowrap";const n=document.createElement("div");n.className="marquee-container",n.style.display="inline-flex",n.style.animation="none";const i=t.innerHTML;n.innerHTML=i+i,t.innerHTML="",t.appendChild(n),V();const a=n.scrollWidth/2,s=window.gsap.timeline({repeat:-1});if(s.set(n,{x:0}).to(n,{x:-a,duration:a/100,ease:"none"}),console.log(`✅ Animation marquee créée avec une largeur de ${a}px`),o){s.pause(0),t.style.overflowX="auto",t.style.touchAction="pan-x",t.style.webkitOverflowScrolling="touch";const r=t.querySelector(".cms_slider_list, .w-dyn-items");r&&(r.style.display="inline-flex",r.style.flexWrap="nowrap",r.style.whiteSpace="nowrap",r.querySelectorAll(".w-dyn-item").forEach(d=>{d.style.display="inline-block"}))}ve(n,s)}function ve(t,e){console.log("✨ Configuration des effets de survol...");const o=t.querySelectorAll('.w-dyn-item, .slide-item, [class*="slide"]'),n=o.length>0?o:t.children;Array.from(n).forEach((i,a)=>{be(i,e,a)})}function be(t,e,o){const n=t.querySelector(".vimeo.activity"),i=t.querySelector("#titre-original");I.set(t,{isHovered:!1,isAnimating:!1,elements:{vimeo:n,titre:i}}),console.log(`🎯 Configuration du slide ${o}:`,{hasVimeo:!!n,hasTitreOriginal:!!i}),t.addEventListener("mouseenter",()=>{const a=I.get(t);if(!a.isHovered){if(console.log(`🎪 Survol du slide ${o}`),a.isHovered=!0,a.isAnimating=!0,S&&S!==t&&Z(S),S=t,e.pause(),n&&window.gsap.killTweensOf(n),i&&window.gsap.killTweensOf(i),n&&(n.style.display="flex",window.gsap.to(n,{opacity:1,duration:.3,ease:"power2.out",onComplete:()=>{a.isAnimating=!1}})),i&&n){const s=i.dataset.originalColor||"#000000",r=Se(s)?"#000000":"#ffffff";window.gsap.to(i,{color:r,duration:.3,ease:"power2.out"})}n||(a.isAnimating=!1)}}),t.addEventListener("mouseleave",()=>{const a=I.get(t);a.isHovered&&(console.log(`🎪 Fin de survol du slide ${o}`),a.isHovered=!1,setTimeout(()=>{!t.matches(":hover")&&S===t&&(Z(t),S=null,e.resume())},50))})}function Z(t){const e=I.get(t);if(!e)return;const{vimeo:o,titre:n}=e.elements;if(o&&window.gsap.killTweensOf(o),n&&window.gsap.killTweensOf(n),e.isAnimating=!0,o&&window.gsap.to(o,{opacity:0,duration:.2,ease:"power2.out",onComplete:()=>{o.style.display="none",e.isAnimating=!1}}),n&&o){const i=n.dataset.originalColor||"#000000";window.gsap.to(n,{color:i,duration:.2,ease:"power2.out"})}e.isHovered=!1,o||(e.isAnimating=!1)}function Se(t){let e,o,n;if(t.startsWith("#")){const a=t.substring(1);e=parseInt(a.substring(0,2),16),o=parseInt(a.substring(2,4),16),n=parseInt(a.substring(4,6),16)}else if(t.startsWith("rgb")){const a=t.match(/\d+/g);e=parseInt(a[0]),o=parseInt(a[1]),n=parseInt(a[2])}else return!1;return(.299*e+.587*o+.114*n)/255>.5}console.log("🚀 main_gsap.js v3.0.2 chargé");function Ce(){console.log("✅ GSAP est prêt. Initialisation des modules...");try{J(),ne(),ie(),ue(),fe(),ge(),new U().init();const t=window.location.pathname;(t==="/offres"||t==="/anniversaires")&&(console.log(`-> Page ${t} détectée. Initialisation du filtrage obligatoire...`),new G().init(),console.log("✅ Module de filtrage obligatoire chargé et initialisé.")),(t==="/"||t==="/index"||t==="")&&(console.log("-> Page d'accueil détectée. Initialisation de l'animation marquee..."),setTimeout(()=>{ye()},500)),pe(),document.querySelector('[data-attribute="preselect-booking-button"]')&&(console.log("-> Bouton de présélection détecté. Initialisation du module."),me()),console.log("✨ Tous les modules principaux ont été initialisés."),X()}catch(t){console.error("❌ Erreur lors de l'initialisation des modules. Forçage du masquage du loader.",t),z()}}function Ee(){K();let t=0;const e=100,n=setInterval(()=>{window.gsap?(clearInterval(n),Ce()):(t++,t>e&&(clearInterval(n),console.error("GSAP n'a pas pu être chargé après 10 secondes. Annulation de l'initialisation des modules."),z()))},100)}window.Webflow=window.Webflow||[],window.Webflow.push(function(){console.log("🚀 Webflow est prêt, lancement de l'attente de GSAP."),Ee()}),window.addEventListener("load",()=>{console.log("🎬 La page est entièrement chargée. Initialisation des modules dépendants du contenu."),ce(),te()})})();
