(function(){"use strict";console.log("🚀 loading-screen.js v1.2.0 chargé");const le={fadeOutDuration:.4,ease:"power2.out"};let ee=!1,te=!1;function Re(){if(console.log("🎬 initLoadingScreen - Début de l'initialisation"),ee)return console.log("ℹ️ Écran de chargement déjà initialisé"),Promise.resolve();const r=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");return console.log("🔍 Éléments trouvés:",{loadingScreen:!!r,logoWrap:!!e}),!r||!e?(console.warn("⚠️ Éléments manquants:",{loadingScreen:r?"OK":"Non trouvé",logoWrap:e?"OK":"Non trouvé"}),ee=!1,Promise.resolve(null)):(console.log("🎨 Configuration des styles initiaux"),window.gsap.set(r,{opacity:1,display:"flex",backgroundColor:"white"}),window.gsap.set(e,{opacity:0,scale:.9}),window.gsap.to(e,{opacity:1,scale:1,duration:.5,delay:.1,ease:le.ease}),ee=!0,console.log("✅ Écran de chargement initialisé avec succès"),Promise.resolve(r))}function ce(){if(console.log("🎬 hideLoadingScreen - Début du masquage"),!ee){console.warn("⚠️ Écran de chargement non initialisé");return}if(te){console.log("ℹ️ Masquage déjà en cours");return}te=!0;const r=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");if(console.log("🔍 Éléments trouvés pour le masquage:",{loadingScreen:!!r,logoWrap:!!e}),!r||!e){console.warn("⚠️ Éléments manquants pour le masquage"),te=!1;return}console.log("🎬 Démarrage de l'animation de masquage"),window.gsap.timeline({onComplete:()=>{console.log("✅ Animation de masquage terminée"),window.gsap.set(r,{display:"none"}),te=!1}}).to(r,{opacity:0,duration:le.fadeOutDuration,ease:le.ease})}console.log("🚀 text-animation.js v2.1.0 chargé");function je(){const r=document.querySelector(".span_mover");if(r)try{let n=function(){if(t)return;t=!0;const i=gsap.timeline({onComplete:()=>{t=!1,gsap.to(r,{y:e.positions.start,duration:e.duration,ease:e.ease,onComplete:()=>{setTimeout(n,e.cycleDelay*1e3)}})}}),a=[e.positions.start,e.positions.middle,e.positions.end];for(let o=0;o<a.length;o++)i.to(r,{y:a[o],duration:e.duration,ease:e.ease}),o<a.length-1&&i.to({},{duration:e.pauseDuration});i.play()};const e={duration:.6,ease:"back.out(1.7)",pauseDuration:1.5,cycleDelay:.5,positions:{start:"0%",middle:"-34%",end:"-68%"}};let t=!1;n(),window.addEventListener("beforeunload",()=>{gsap.killTweensOf(r)})}catch(e){console.error("Erreur dans l'animation de texte:",e)}}console.log("🚀 faq-toggle.js v2.0.0 chargé");let K=!1;async function ye(r){if(!r||!r.classList.contains("is-open"))return;K=!0;const e=r.querySelector(".faq_respond"),t=r.querySelector(".svg-holder.medium");r.classList.remove("is-open"),await window.gsap.to(e,{height:0,opacity:0,duration:.3,ease:"power1.in"}),t&&window.gsap.to(t,{rotation:0,duration:.2,ease:"power1.inOut"}),e.style.display="none",K=!1}async function De(r){if(!r||r.classList.contains("is-open"))return;K=!0;const e=r.querySelector(".faq_respond"),t=r.querySelector(".svg-holder.medium");r.classList.add("is-open"),window.gsap.set(e,{display:"block",height:"auto",opacity:0});const n=e.scrollHeight;t&&window.gsap.to(t,{rotation:90,duration:.3,ease:"back.out(1.7)"}),await window.gsap.fromTo(e,{height:0,opacity:0},{height:n,opacity:1,duration:.5,ease:"elastic.out(1.2, 0.5)"}),K=!1}async function $e(r){if(K)return;if(r.classList.contains("is-open"))await ye(r);else{const t=document.querySelectorAll(".faq_item.is-open");await Promise.all(Array.from(t).map(n=>ye(n))),await De(r)}}function Ne(){document.querySelectorAll(".faq_item.effect-cartoon-shadow").forEach(e=>{const t=e.querySelector(".faq_wrapper");if(t){if(t.dataset.faqInitialized)return;t.dataset.faqInitialized="true",t.addEventListener("click",n=>{n.target.closest(".faq_respond a, .faq_respond button")||(n.preventDefault(),$e(e))})}})}console.log('🚀 menu-desktop.js v14.0.0 chargé - Stratégie "Wrapper"');class Fe{constructor(){this.activePanel=null,this.isAnimating=!1,this.triggerSelector='[data-attribute^="nav-link-desktop-"]',this.wrapperSelector=".desktop_menu_wrapper",this.panelClassMap={parcs:".parc_menu_desktop",activites:".activites_menu_desktop",offres:".offres_menu_desktop"},this._addGlobalListener(),console.log('✅ Gestionnaire de clic "Stratégie Wrapper" est actif.')}_addGlobalListener(){document.body.addEventListener("click",e=>{if(this.isAnimating)return;const t=e.target.closest(this.triggerSelector),n=document.querySelector(this.wrapperSelector);if(this.activePanel&&!t&&!this.activePanel.contains(e.target)){this._closeAll();return}if(!t)return;if(e.preventDefault(),e.stopPropagation(),!n){console.error(`Wrapper introuvable avec le sélecteur: ${this.wrapperSelector}`);return}const i=t.getAttribute("data-attribute").replace("nav-link-desktop-",""),a=n.querySelector(this.panelClassMap[i]);if(!a){console.error(`Panneau cible pour la clé "${i}" non trouvé dans le wrapper.`);return}const o=this.activePanel===a,s=!this.activePanel;o?this._closeAll():s?this._openWrapperAndPanel(a):this._switchPanels(this.activePanel,a)})}_openWrapperAndPanel(e){const t=document.querySelector(this.wrapperSelector);this.isAnimating=!0,window.gsap.set(t,{display:"flex",opacity:0}),Object.values(this.panelClassMap).forEach(n=>{const i=t.querySelector(n);i&&window.gsap.set(i,{display:"none"})}),window.gsap.set(e,{display:"flex"}),window.gsap.to(t,{opacity:1,duration:.3,ease:"power2.out",onComplete:()=>{this.isAnimating=!1,this.activePanel=e}})}_closeAll(){const e=document.querySelector(this.wrapperSelector);!this.activePanel||!e||(this.isAnimating=!0,window.gsap.to(e,{opacity:0,duration:.2,ease:"power1.in",onComplete:()=>{window.gsap.set(e,{display:"none"}),this.activePanel&&window.gsap.set(this.activePanel,{display:"none"}),this.activePanel=null,this.isAnimating=!1}}))}_switchPanels(e,t){this.isAnimating=!0;const n=window.gsap.timeline({onComplete:()=>{this.isAnimating=!1,this.activePanel=t}});n.to(e,{opacity:0,duration:.15,onComplete:()=>window.gsap.set(e,{display:"none"})}),n.set(t,{display:"flex",opacity:0}),n.to(t,{opacity:1,duration:.15})}}function We(){new Fe}function Be(){const r=document.querySelector("#hamburger-menu"),e=document.querySelector("#main-menu-mobile"),t=document.body,n=document.querySelector("#parcs-nav_button_mobile"),i=document.querySelector("#activites-nav_button_mobile"),a=document.querySelector("#formules-nav_button_mobile"),o=document.querySelector("#parc-menu-mobile"),s=document.querySelector("#activite-menu-mobile"),c=document.querySelector("#offres-menu-mobile"),l=document.querySelectorAll(".button-close"),k=document.querySelectorAll(".button-back-menu");let y=!1,P=0,S=window.gsap.timeline({paused:!0});const w=window.gsap.timeline({paused:!0});w.to(r,{rotation:90,duration:.4,ease:"elastic.out(1, 0.5)",transformOrigin:"center center"}),[e,o,s,c].forEach(f=>{f.style.display="none"});function I(){P=window.pageYOffset||document.documentElement.scrollTop,t.style.overflow="hidden",t.style.position="fixed",t.style.width="100%",t.style.top=`-${P}px`}function L(){t.style.overflow="",t.style.position="",t.style.width="",t.style.top="",window.scrollTo(0,P)}function O(){return window.gsap.timeline({paused:!0}).add(()=>{e.style.display="flex",[o,s,c].forEach(f=>{f.style.display="none"})},"openMainMenu").add(()=>{e.style.display="none",o.style.display="flex"},"openParcMenu").add(()=>{e.style.display="none",s.style.display="flex"},"openActiviteMenu").add(()=>{e.style.display="none",c.style.display="flex"},"openOffresMenu")}S=O();function g(f=null){[n,i,a,document.querySelector("#parcs-nav_button"),document.querySelector("#activites-nav_button"),document.querySelector("#formules-nav_button")].forEach(C=>{C&&(f&&C.id===f?C.classList.add("active"):C.classList.remove("active"))})}function h(f){f?w.play():w.reverse()}function m(f){const C={"parcs-nav_button":o,"activites-nav_button":s,"formules-nav_button":c,"parcs-nav_button_mobile":o,"activites-nav_button_mobile":s,"formules-nav_button_mobile":c}[f];if(C){if(e.style.display="none",o.style.display="none",s.style.display="none",c.style.display="none",y&&C.style.display==="flex"){y=!1,L(),g(),h(!1);return}requestAnimationFrame(()=>{C.style.display="flex",y=!0,I(),g(f),h(!0)})}}function b(){S&&S.kill(),y=!1,[e,o,s,c].forEach(f=>{f.style.display="none"}),L(),g(),h(!1),S=O()}function E(){[o,s,c].forEach(f=>{f.style.display="none"}),e.style.display="flex",y=!0}function A(f){e.style.display="none",y=!0,f.style.display="flex"}r.addEventListener("click",()=>{y?b():([o,s,c].forEach(f=>{f.style.display="none"}),e.style.display="flex",y=!0,I(),h(!0))}),n.addEventListener("click",()=>A(o)),i.addEventListener("click",()=>A(s)),a.addEventListener("click",()=>A(c)),l.forEach(f=>{f.addEventListener("click",b)}),k.forEach(f=>{f.addEventListener("click",E)}),document.querySelectorAll("#parcs-nav_button, #activites-nav_button, #formules-nav_button, #parcs-nav_button_mobile, #activites-nav_button_mobile, #formules-nav_button_mobile").forEach(f=>{f.addEventListener("click",q=>{q.preventDefault(),m(f.id)})})}console.log("🚀 centre-card.js v6.0.0 chargé – Logique old.js réintégrée");const N={CARD:".centre-card_wrapper.effect-cartoon-shadow",CLICKABLE_WRAP:'.clickable_wrap[data-attribute="data-card-toggle"]',TOGGLE_ELEMENTS:[".centre-card_scroll_wrapper",".centre-card_list",".centre-card_button-holder",".tag_holder_wrapper"],ARROW:".svg-holder.arrow",INTERNAL_LINKS:".centre-card_button-holder a, .centre-card_button-holder button"},we=new WeakSet;let ue=!1;async function be(r){if(!r||!r.classList.contains("is-open"))return;const e=r.querySelectorAll(N.TOGGLE_ELEMENTS.join(",")),t=r.querySelector(N.ARROW);r.classList.remove("is-open");const n=window.gsap.timeline({onComplete:()=>{window.gsap.set(e,{display:"none"})}});n.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in",stagger:.02},0),t&&n.to(t,{rotation:0,duration:.25,ease:"power2.inOut"},0),await n}async function Ve(r){if(!r||r.classList.contains("is-open"))return;r.classList.add("is-open");const e=r.querySelectorAll(N.TOGGLE_ELEMENTS.join(",")),t=r.querySelector(N.ARROW);e.forEach(i=>{window.gsap.set(i,{display:i.dataset.originalDisplay||"block",opacity:0,y:-20})});const n=window.gsap.timeline();t&&n.to(t,{rotation:90,duration:.25,ease:"back.out(1.7)"},"<"),n.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out",stagger:.035},"<0.05"),await n}async function ze(r){if(!ue){ue=!0;try{if(r.classList.contains("is-open"))await be(r);else{const t=document.querySelectorAll(`${N.CARD}.is-open`);await Promise.all(Array.from(t).map(n=>be(n))),await Ve(r)}}finally{ue=!1}}}function de(r){if(!r||we.has(r))return;const e=r.parentElement.querySelector(N.CLICKABLE_WRAP);if(!e)return;const t=r.querySelectorAll(N.TOGGLE_ELEMENTS.join(","));t.forEach(i=>{i.dataset.originalDisplay=window.getComputedStyle(i).display}),window.gsap.set(t,{display:"none",opacity:0,y:-20});const n=i=>{i.target.closest(N.INTERNAL_LINKS)||(i.preventDefault(),i.stopPropagation(),ze(r))};e.addEventListener("click",n),we.add(r)}function Ge(){const r=document.querySelector(".collection-list-centre-wrapper");if(!r)return;new MutationObserver(t=>{for(const n of t)n.type==="childList"&&n.addedNodes.forEach(i=>{i.nodeType===1&&(i.matches(N.CARD)&&de(i),i.querySelectorAll(N.CARD).forEach(de))})}).observe(r,{childList:!0,subtree:!0})}function Ue(){document.querySelectorAll(N.CARD).forEach(de),Ge()}function He(){console.group("--- Informations de Débogage ---"),console.log("Wrapper Menu Desktop:",document.querySelector(".desktop_menu_wrapper")),console.log("Boutons de menu:",{parcs:document.querySelector('[data-attribute="nav-link-desktop-parcs"]'),activites:document.querySelector('[data-attribute="nav-link-desktop-activites"]'),offres:document.querySelector('[data-attribute="nav-link-desktop-offres"]')}),console.log("Conteneurs de menu:",{parcs:document.querySelector(".parc_menu_desktop"),activites:document.querySelector(".activites_menu_desktop"),offres:document.querySelector(".offres_menu_desktop")}),console.groupEnd()}function Ke(){window.location.hash==="#debug"&&(console.log("🐛 Mode de débogage activé."),He())}class Qe{constructor(){this.config={defaultVideoUrl:"https://player.vimeo.com/progressive_redirect/playback/1088767237/rendition/1080p/file.mp4?loc=external&signature=1d46b415bde9b315b01d645374b5f7319940ecff5995ac8ac213f847577f6536",ids:{initialContainer:"container-initial",filteredContainer:"container-filtre",hiddenMap:"hidden-map",initialActivitiesPane:"tab-pane-initial-activites",initialParksPane:"tab-pane-initial-parcs",filteredActivitiesPane:"tab-pane-filtre-activites",filteredParksPane:"tab-pane-filtre-parcs",initialActivitiesTabLink:"tab-link-initial-activites",initialParksTabLink:"tab-link-initial-parcs",filteredActivitiesTabLink:"tab-link-filtre-activites",filteredParksTabLink:"tab-link-filtre-parcs",selectionWrapper:"selection-wrapper",label:"selection-label",reserveBtn:"reserve-btn",iframeWrap:"iframe-wrapper"}},this.state={primarySelectionType:null,selectedInitialSlugs:new Set,selectedInitialParkId:null,finalSelectedParkId:null,finalSelectedSlugs:new Set},this.dom={},this.mapItems=[],this.init()}init(){this._setupDomElements()&&(this._injectStyles(),this._injectVideoPlayer(),this._setupEventListeners(),this._applyUrlParameters(),this._setInitialUiState())}_setupDomElements(){for(const e in this.config.ids)if(this.dom[e]=document.getElementById(this.config.ids[e]),!this.dom[e])return console.error(`[SW-RSV] Essential element #${this.config.ids[e]} is missing.`),!1;return this.dom.videoBackgroundDiv=document.querySelector('[data-attribute="video_background"]'),this.dom.resetButton=document.querySelector('[data-attribute="reset_form"]'),this.mapItems=Array.from(this.dom.hiddenMap.querySelectorAll(".map-item")),!0}_setInitialUiState(){this.dom.filteredContainer.style.display="none",this.dom.reserveBtn.classList.add("disabled"),this.dom.iframeWrap.style.display="none",this.dom.selectionWrapper&&(window.gsap.set(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none"}),window.gsap.set(this.dom.label,{opacity:0}))}_setupEventListeners(){this.dom.initialActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"initialActivity")),this.dom.initialParksPane.addEventListener("click",this._handleSelection.bind(this,"initialPark")),this.dom.filteredActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"finalActivity")),this.dom.filteredParksPane.addEventListener("click",this._handleSelection.bind(this,"finalPark")),this.dom.reserveBtn.addEventListener("click",this._handleReserveClick.bind(this)),this.dom.resetButton&&this.dom.resetButton.addEventListener("click",this._fullReset.bind(this))}_handleSelection(e,t){const n=t.target.closest("[data-activity-slug], [data-centre-apex-id]");if(!n)return;const i=n.dataset.activitySlug,a=n.dataset.centreApexId;switch(e){case"initialActivity":this._handleInitialActivitySelection(i,n);break;case"initialPark":this._handleInitialParkSelection(a,n);break;case"finalActivity":this._handleFinalActivitySelection(i,n);break;case"finalPark":this._handleFinalParkSelection(a,n);break}}_handleInitialActivitySelection(e,t){if(this.state.primarySelectionType==="parks"&&(this._resetInitialSelections("parks"),this._resetInitialTabs()),this.state.primarySelectionType="activities",t.classList.toggle("isSelected"),t.classList.contains("isSelected")?this.state.selectedInitialSlugs.add(e):this.state.selectedInitialSlugs.delete(e),this._resetFinalSelections(),this.state.selectedInitialSlugs.size>0){this.dom.initialParksTabLink.style.display="none";const n=Array.from(this.state.selectedInitialSlugs).map(o=>new Set(this.mapItems.filter(s=>s.dataset.activitySlug===o).map(s=>s.dataset.centreApexId))),i=n.length>0?n[0]:new Set,a=n.reduce((o,s)=>new Set([...o].filter(c=>s.has(c))),i);this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(o=>{o.style.display=a.has(o.dataset.centreApexId)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("parks")}else this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this.state.primarySelectionType=null;this._updateStateAndButton()}_handleInitialParkSelection(e,t){this.state.primarySelectionType==="activities"&&(this._resetInitialSelections("activities"),this._resetInitialTabs()),this.state.primarySelectionType="parks";const n=this.state.selectedInitialParkId===e;if(this._resetFinalSelections(),n)this.state.selectedInitialParkId=null,t.classList.remove("isSelected"),this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this._updateVideoSource(null);else{this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(a=>a.classList.remove("isSelected")),this.state.selectedInitialParkId=e,t.classList.add("isSelected"),this._updateVideoSource(t),this.dom.initialActivitiesTabLink.style.display="none";const i=new Set(this.mapItems.filter(a=>a.dataset.centreApexId===e).map(a=>a.dataset.activitySlug));this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(a=>{a.style.display=i.has(a.dataset.activitySlug)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("activities")}this._updateStateAndButton()}_handleFinalParkSelection(e,t){this.state.primarySelectionType==="activities"&&(this.state.finalSelectedParkId===e?(this.state.finalSelectedParkId=null,t.classList.remove("isSelected"),this._updateVideoSource(null)):(this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(n=>n.classList.remove("isSelected")),this.state.finalSelectedParkId=e,t.classList.add("isSelected"),this._updateVideoSource(t)),this._updateStateAndButton())}_handleFinalActivitySelection(e,t){this.state.primarySelectionType==="parks"&&(t.classList.toggle("isSelected"),t.classList.contains("isSelected")?this.state.finalSelectedSlugs.add(e):this.state.finalSelectedSlugs.delete(e),this._updateStateAndButton())}_handleReserveClick(e){if(this.dom.reserveBtn.classList.contains("disabled")){e.preventDefault();return}e.preventDefault();const t=this.dom.reserveBtn.href;if(t&&t!=="#"){this.dom.iframeWrap.innerHTML=`<iframe src="${t}" style="width: 100%; height: 100vh; border: none;"></iframe>`,this.dom.iframeWrap.style.display="block";const n=this.dom.iframeWrap.getBoundingClientRect().top+window.scrollY,a=7*parseFloat(getComputedStyle(document.documentElement).fontSize);window.scrollTo({top:n-a,behavior:"smooth"})}}_updateStateAndButton(){let e=null,t=null;if(this.state.primarySelectionType==="activities"?(e=this.state.finalSelectedParkId,t=this.state.selectedInitialSlugs):this.state.primarySelectionType==="parks"&&(e=this.state.selectedInitialParkId,t=this.state.finalSelectedSlugs),e&&t&&t.size>0){const n=Array.from(t).map(i=>{const a=this.mapItems.find(o=>o.dataset.centreApexId===e&&o.dataset.activitySlug===i);return a?a.dataset.activityApexId:null}).filter(Boolean);if(n.length===t.size){const i=n.join(",");this.dom.reserveBtn.href=`https://www.apex-timing.com/gokarts/sessions_booking.php?center=${e}&categories=${i}&language=fr&iframe_id=axiframe_0`,this.dom.reserveBtn.classList.remove("disabled");const a=this.state.primarySelectionType==="activities"?this.dom.filteredParksPane.querySelector(`[data-centre-apex-id="${e}"]`):this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${e}"]`),o=a?a.dataset.parkLabel:"",s=Array.from(t).map(c=>{const l=this.state.primarySelectionType==="activities"?this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${c}"]`):this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${c}"]`);return l?l.dataset.activityLabel:c});this.dom.label.textContent=`C'est parti pour ${s.map(c=>`un ${c}`).join(" & ")} à ${o} !`,this._animateSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="La combinaison sélectionnée est invalide.",this._resetSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="Veuillez terminer votre sélection.",this._resetSelectionAppearance()}_switchFilteredTab(e){const t="w--current",n=e==="parks"?"Parks":"Activities",i=e==="parks"?"Activities":"Parks";this.dom[`filtered${n}TabLink`].classList.add(t),this.dom[`filtered${i}TabLink`].classList.remove(t),this.dom[`filtered${n}Pane`].classList.add(t),this.dom[`filtered${i}Pane`].classList.remove(t),this.dom[`filtered${n}TabLink`].style.display="inline-block",this.dom[`filtered${n}Pane`].style.display="block",this.dom[`filtered${i}TabLink`].style.display="none",this.dom[`filtered${i}Pane`].style.display="none"}_animateSelectionAppearance(){if(!this.dom.selectionWrapper)return;window.gsap.timeline().to(this.dom.selectionWrapper,{opacity:1,pointerEvents:"auto",duration:.4,ease:"power2.inOut"}).from(this.dom.selectionWrapper,{scale:.9,ease:"elastic.out(1, 0.6)",duration:1.2},"-=0.2").to(this.dom.label,{opacity:1,duration:.5},"-=1")}_resetSelectionAppearance(){this.dom.selectionWrapper&&(window.gsap.to(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none",duration:.3}),window.gsap.to(this.dom.label,{opacity:0,duration:.2}))}_updateVideoSource(e){if(!this.dom.videoBackgroundDiv)return;const t=this.dom.videoBackgroundDiv.querySelector("source"),n=this.dom.videoBackgroundDiv.querySelector("video");if(!t||!n)return;const i=e&&e.dataset.video?e.dataset.video:this.config.defaultVideoUrl;t.src!==i&&(t.src=i,n.load(),n.play().catch(()=>{}))}_fullReset(e){e&&e.preventDefault(),this.state.primarySelectionType=null,this._resetInitialSelections("activities"),this._resetInitialSelections("parks"),this._resetFinalSelections(),this._resetInitialTabs(),this._resetFilteredTabs(),this.dom.filteredContainer.style.display="none",this.dom.iframeWrap.style.display="none",this._updateStateAndButton()}_resetInitialTabs(){this.dom.initialActivitiesTabLink&&(this.dom.initialActivitiesTabLink.style.display="flex"),this.dom.initialParksTabLink&&(this.dom.initialParksTabLink.style.display="flex")}_resetInitialSelections(e){e==="activities"?(this.dom.initialActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(t=>t.classList.remove("isSelected")),this.state.selectedInitialSlugs.clear()):e==="parks"&&(this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(t=>t.classList.remove("isSelected")),this.state.selectedInitialParkId=null,this._updateVideoSource(null))}_resetFinalSelections(){this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedSlugs.clear(),this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedParkId=null}_resetFilteredTabs(){this.dom.filteredActivitiesTabLink.style.display="inline-block",this.dom.filteredParksTabLink.style.display="inline-block"}_injectStyles(){const e=document.createElement("style");e.id="sw-rsv-styles",e.textContent=`
        .isSelected .tags_content { background-color: black !important; color: white !important; }
        .isSelected .tags_content * { color: white !important; }`,document.head.appendChild(e)}_injectVideoPlayer(){this.dom.videoBackgroundDiv.innerHTML=`<video playsinline autoplay muted loop class="background-video_element"><source src="${this.config.defaultVideoUrl}" type="video/mp4"></video>`}_applyUrlParameters(){const e=new URLSearchParams(window.location.search),t=e.get("activite"),n=e.get("parc");!t&&!n||(n&&t?(this.dom.initialParksTabLink&&this.dom.initialParksTabLink.click(),setTimeout(()=>{const i=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${n}"]`);i&&i.click(),setTimeout(()=>{const a=this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${t}"]`);a&&a.click()},100)},100)):t?(this.dom.initialActivitiesTabLink&&this.dom.initialActivitiesTabLink.click(),setTimeout(()=>{const i=this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${t}"]`);i&&i.click()},100)):n&&(this.dom.initialParksTabLink&&this.dom.initialParksTabLink.click(),setTimeout(()=>{const i=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${n}"]`);i&&i.click()},100)))}}function Ye(){new Qe}console.log("🗺️ map-integration.js v2.0.1 chargé");const fe={map:null,markers:[],infoWindow:null,initialCenter:{lat:48.82,lng:2.25},initialZoom:10,initMap:function(){const r=document.getElementById("map");if(!r){console.error("Erreur : L'élément #map est introuvable dans le DOM.");return}const e=r.dataset.mapId;e||console.warn("⚠️ data-map-id n'est pas défini sur l'élément #map. Les marqueurs avancés pourraient ne pas fonctionner."),this.map=new google.maps.Map(r,{center:this.initialCenter,zoom:this.initialZoom,disableDefaultUI:!0,zoomControl:!0,mapId:e}),this.infoWindow=new google.maps.InfoWindow,google.maps.event.addListener(this.infoWindow,"closeclick",()=>{this.resetMapView()}),this.createMarkers()},createMarkers:function(){const r=document.querySelectorAll(".w-dyn-item[data-place-id]");console.log(`📍 ${r.length} cartes trouvées pour la création des marqueurs.`),r.forEach(e=>{var o,s;const t=parseFloat(e.dataset.lat),n=parseFloat(e.dataset.lng),i=e.dataset.placeId;if(isNaN(t)||isNaN(n)||!i){const c=((o=e.querySelector("h3"))==null?void 0:o.textContent)||"Nom non trouvé";console.warn(`⚠️ Carte ignorée (nom: "${c}") car ses données de latitude/longitude sont manquantes ou invalides.`,e);return}const a=new google.maps.marker.AdvancedMarkerElement({map:this.map,position:{lat:t,lng:n},title:((s=e.querySelector("h3"))==null?void 0:s.textContent)||"Centre Smile World"});a.addListener("click",()=>{this.focusOnCenter(i)}),this.markers.push({placeId:i,marker:a})})},focusOnCenter:async function(r){var e;if(!(!r||!this.map)){console.log(`🔎 Zoom sur le centre avec Place ID : ${r}`);try{const{Place:t}=await google.maps.importLibrary("places"),n=new t({id:r}),i=["displayName","formattedAddress","location","rating","googleMapsURI","photos","reviews","userRatingCount","regularOpeningHours"];if(await n.fetchFields({fields:i}),n.location){this.map.panTo(n.location),this.map.setZoom(15);const a=this.buildInfoWindowContent(n);this.infoWindow.setContent(a);const o=(e=this.markers.find(s=>s.placeId===r))==null?void 0:e.marker;o&&this.infoWindow.open(this.map,o)}else console.error(`Aucune donnée de localisation trouvée pour le Place ID ${r}`)}catch(t){console.error(`Erreur lors de la récupération des détails pour le Place ID ${r}:`,t)}}},buildInfoWindowContent:function(r){let e="";r.photos&&r.photos.length>0&&(e=`<img src="${r.photos[0].getURI({maxWidth:400,maxHeight:200})}" alt="Photo de ${r.displayName}" style="width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;">`);let t="";r.rating&&(t=`
                <div style="display: flex; align-items: center; color: #555; margin-bottom: 8px; font-size: 14px;">
                    <span style="color: #f8b400; font-size: 18px; margin-right: 8px;">${"★".repeat(Math.round(r.rating))+"☆".repeat(5-Math.round(r.rating))}</span>
                    <span style="font-weight: bold; color: #111; margin-right: 5px;">${r.rating.toFixed(1)}</span>
                    <span>(${r.userRatingCount||0} avis)</span>
                </div>`);let n="";if(r.reviews&&r.reviews.length>0){const a=r.reviews[0];a.text&&(n=`
                    <div style="margin-top: 16px;">
                        <strong style="display: block; font-size: 14px; color: #111; margin-bottom: 8px; font-weight: 600;">Dernier avis</strong>
                        <div style="border-left: 3px solid #f0f0f0; padding-left: 12px; font-style: italic;">
                            <p style="margin: 0 0 5px 0; font-size: 13px; color: #555;">"${a.text.substring(0,100)}..."</p>
                            <span style="font-weight: 500; font-size: 12px; color: #333;">- ${a.authorAttribution.displayName}</span>
                        </div>
                    </div>
                `)}let i="";if(r.regularOpeningHours&&r.regularOpeningHours.weekdayDescriptions){const a=new Date().getDay(),o=a===0?6:a-1;i=`<div style="font-size: 13px; color: #333; margin-bottom: 12px; display: flex; align-items: center;"><svg viewBox="0 0 24 24" style="width:16px; height:16px; margin-right: 8px; fill: #555;"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6h6v-2h-4V7z"></path></svg><span>${r.regularOpeningHours.weekdayDescriptions[o]}</span></div>`}return`
            <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; max-width: 290px; padding: 5px;">
                ${e}
                <div style="font-size: 18px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px;">${r.displayName}</div>
                <div style="font-size: 13px; color: #555; margin-bottom: 8px;">${r.formattedAddress}</div>
                ${t}
                ${i}
                <a href="${r.googleMapsURI}" target="_blank" style="display: inline-block; margin-top: 8px; font-size: 13px; color: #1a73e8; text-decoration: none; font-weight: 500;">Voir sur Google Maps</a>
                ${n}
            </div>
        `},resetMapView:function(){this.map&&(console.log("🔄 Réinitialisation de la vue de la carte."),this.infoWindow.close(),this.map.panTo(this.initialCenter),this.map.setZoom(this.initialZoom))}};window.initGoogleMap=fe.initMap.bind(fe);function Ze(){const r=document.getElementById("map");if(!r)return;const e=r.dataset.apiKey;if(!e){console.error(`❌ Clé API Google Maps manquante. Veuillez l'ajouter dans l'attribut "data-api-key" de la div #map.`);return}if(window.google&&window.google.maps){console.log("🗺️ Google Maps API déjà chargée."),fe.initMap();return}console.log("🗺️ Chargement de l'API Google Maps...");const t=document.createElement("script");t.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places,marker&callback=initGoogleMap&language=fr`,t.async=!0,t.setAttribute("loading","async"),document.head.appendChild(t)}console.log("🚪 privateroom.js prêt à être initialisé");function Je(){const r=document.querySelector('[data-attribute="matterport_button"]'),e=document.querySelector('[data-attribute="matterport_popup"]'),t=document.querySelector('[data-attribute="close_popup"]');if(!r||!e||!t){console.warn("-> Éléments pour le popup de salle privatisable non trouvés. Le module ne s'activera pas.");return}console.log("✅ Popup de salle privatisable initialisé."),window.gsap.set(e,{display:"none",opacity:0,scale:.95,y:"20px"});const n=window.gsap.timeline({paused:!0}).to(e,{display:"flex"}).to(e,{opacity:1,scale:1,y:"0px",duration:.4,ease:"power3.out"}),i=window.gsap.timeline({paused:!0,onComplete:()=>{window.gsap.set(e,{display:"none"})}}).to(e,{opacity:0,scale:.95,y:"20px",duration:.3,ease:"power3.in"}),a=s=>{s.preventDefault(),!(n.isActive()||i.isActive())&&n.restart()},o=s=>{s.preventDefault(),!(n.isActive()||i.isActive())&&i.restart()};r.addEventListener("click",a),t.addEventListener("click",o)}console.log("🔗 preselect.js prêt à être initialisé");function Xe(){const r="[SW-PRESELECT]",e=(...c)=>console.log(new Date().toLocaleTimeString(),r,...c),t="/reservation",n=document.querySelector("[data-preselect-activity-slug], [data-preselect-park-id]");if(!n){console.warn(r,"Aucun élément wrapper avec [data-preselect-activity-slug] ou [data-preselect-park-id] trouvé.");return}const i=document.querySelectorAll('[data-attribute="preselect-booking-button"]');console.log("✅ Module de présélection initialisé.");const a=n.dataset.preselectActivitySlug,o=n.dataset.preselectParkId,s=new URLSearchParams;if(a&&s.set("activite",a),o&&s.set("parc",o),s.toString()){const c=`${t}?${s.toString()}`;i.forEach(l=>{l.href=c,l.addEventListener("click",function(k){k.preventDefault(),k.stopPropagation(),window.location.href=c},!0)}),e(`Liens de réservation mis à jour et clics gérés pour pointer vers : ${c}`)}}/*! @vimeo/player v2.29.0 | (c) 2025 Vimeo | MIT License | https://github.com/vimeo/player.js */function ke(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Se(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ke(Object(t),!0).forEach(function(n){ne(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ke(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function x(){x=function(){return r};var r={},e=Object.prototype,t=e.hasOwnProperty,n=Object.defineProperty||function(d,u,p){d[u]=p.value},i=typeof Symbol=="function"?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(d,u,p){return Object.defineProperty(d,u,{value:p,enumerable:!0,configurable:!0,writable:!0}),d[u]}try{c({},"")}catch{c=function(u,p,_){return u[p]=_}}function l(d,u,p,_){var v=u&&u.prototype instanceof P?u:P,T=Object.create(v.prototype),M=new q(_||[]);return n(T,"_invoke",{value:b(d,p,M)}),T}function k(d,u,p){try{return{type:"normal",arg:d.call(u,p)}}catch(_){return{type:"throw",arg:_}}}r.wrap=l;var y={};function P(){}function S(){}function w(){}var I={};c(I,a,function(){return this});var L=Object.getPrototypeOf,O=L&&L(L(C([])));O&&O!==e&&t.call(O,a)&&(I=O);var g=w.prototype=P.prototype=Object.create(I);function h(d){["next","throw","return"].forEach(function(u){c(d,u,function(p){return this._invoke(u,p)})})}function m(d,u){function p(v,T,M,j){var D=k(d[v],d,T);if(D.type!=="throw"){var H=D.arg,X=H.value;return X&&typeof X=="object"&&t.call(X,"__await")?u.resolve(X.__await).then(function(z){p("next",z,M,j)},function(z){p("throw",z,M,j)}):u.resolve(X).then(function(z){H.value=z,M(H)},function(z){return p("throw",z,M,j)})}j(D.arg)}var _;n(this,"_invoke",{value:function(v,T){function M(){return new u(function(j,D){p(v,T,j,D)})}return _=_?_.then(M,M):M()}})}function b(d,u,p){var _="suspendedStart";return function(v,T){if(_==="executing")throw new Error("Generator is already running");if(_==="completed"){if(v==="throw")throw T;return ve()}for(p.method=v,p.arg=T;;){var M=p.delegate;if(M){var j=E(M,p);if(j){if(j===y)continue;return j}}if(p.method==="next")p.sent=p._sent=p.arg;else if(p.method==="throw"){if(_==="suspendedStart")throw _="completed",p.arg;p.dispatchException(p.arg)}else p.method==="return"&&p.abrupt("return",p.arg);_="executing";var D=k(d,u,p);if(D.type==="normal"){if(_=p.done?"completed":"suspendedYield",D.arg===y)continue;return{value:D.arg,done:p.done}}D.type==="throw"&&(_="completed",p.method="throw",p.arg=D.arg)}}}function E(d,u){var p=u.method,_=d.iterator[p];if(_===void 0)return u.delegate=null,p==="throw"&&d.iterator.return&&(u.method="return",u.arg=void 0,E(d,u),u.method==="throw")||p!=="return"&&(u.method="throw",u.arg=new TypeError("The iterator does not provide a '"+p+"' method")),y;var v=k(_,d.iterator,u.arg);if(v.type==="throw")return u.method="throw",u.arg=v.arg,u.delegate=null,y;var T=v.arg;return T?T.done?(u[d.resultName]=T.value,u.next=d.nextLoc,u.method!=="return"&&(u.method="next",u.arg=void 0),u.delegate=null,y):T:(u.method="throw",u.arg=new TypeError("iterator result is not an object"),u.delegate=null,y)}function A(d){var u={tryLoc:d[0]};1 in d&&(u.catchLoc=d[1]),2 in d&&(u.finallyLoc=d[2],u.afterLoc=d[3]),this.tryEntries.push(u)}function f(d){var u=d.completion||{};u.type="normal",delete u.arg,d.completion=u}function q(d){this.tryEntries=[{tryLoc:"root"}],d.forEach(A,this),this.reset(!0)}function C(d){if(d){var u=d[a];if(u)return u.call(d);if(typeof d.next=="function")return d;if(!isNaN(d.length)){var p=-1,_=function v(){for(;++p<d.length;)if(t.call(d,p))return v.value=d[p],v.done=!1,v;return v.value=void 0,v.done=!0,v};return _.next=_}}return{next:ve}}function ve(){return{value:void 0,done:!0}}return S.prototype=w,n(g,"constructor",{value:w,configurable:!0}),n(w,"constructor",{value:S,configurable:!0}),S.displayName=c(w,s,"GeneratorFunction"),r.isGeneratorFunction=function(d){var u=typeof d=="function"&&d.constructor;return!!u&&(u===S||(u.displayName||u.name)==="GeneratorFunction")},r.mark=function(d){return Object.setPrototypeOf?Object.setPrototypeOf(d,w):(d.__proto__=w,c(d,s,"GeneratorFunction")),d.prototype=Object.create(g),d},r.awrap=function(d){return{__await:d}},h(m.prototype),c(m.prototype,o,function(){return this}),r.AsyncIterator=m,r.async=function(d,u,p,_,v){v===void 0&&(v=Promise);var T=new m(l(d,u,p,_),v);return r.isGeneratorFunction(u)?T:T.next().then(function(M){return M.done?M.value:T.next()})},h(g),c(g,s,"Generator"),c(g,a,function(){return this}),c(g,"toString",function(){return"[object Generator]"}),r.keys=function(d){var u=Object(d),p=[];for(var _ in u)p.push(_);return p.reverse(),function v(){for(;p.length;){var T=p.pop();if(T in u)return v.value=T,v.done=!1,v}return v.done=!0,v}},r.values=C,q.prototype={constructor:q,reset:function(d){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(f),!d)for(var u in this)u.charAt(0)==="t"&&t.call(this,u)&&!isNaN(+u.slice(1))&&(this[u]=void 0)},stop:function(){this.done=!0;var d=this.tryEntries[0].completion;if(d.type==="throw")throw d.arg;return this.rval},dispatchException:function(d){if(this.done)throw d;var u=this;function p(D,H){return T.type="throw",T.arg=d,u.next=D,H&&(u.method="next",u.arg=void 0),!!H}for(var _=this.tryEntries.length-1;_>=0;--_){var v=this.tryEntries[_],T=v.completion;if(v.tryLoc==="root")return p("end");if(v.tryLoc<=this.prev){var M=t.call(v,"catchLoc"),j=t.call(v,"finallyLoc");if(M&&j){if(this.prev<v.catchLoc)return p(v.catchLoc,!0);if(this.prev<v.finallyLoc)return p(v.finallyLoc)}else if(M){if(this.prev<v.catchLoc)return p(v.catchLoc,!0)}else{if(!j)throw new Error("try statement without catch or finally");if(this.prev<v.finallyLoc)return p(v.finallyLoc)}}}},abrupt:function(d,u){for(var p=this.tryEntries.length-1;p>=0;--p){var _=this.tryEntries[p];if(_.tryLoc<=this.prev&&t.call(_,"finallyLoc")&&this.prev<_.finallyLoc){var v=_;break}}v&&(d==="break"||d==="continue")&&v.tryLoc<=u&&u<=v.finallyLoc&&(v=null);var T=v?v.completion:{};return T.type=d,T.arg=u,v?(this.method="next",this.next=v.finallyLoc,y):this.complete(T)},complete:function(d,u){if(d.type==="throw")throw d.arg;return d.type==="break"||d.type==="continue"?this.next=d.arg:d.type==="return"?(this.rval=this.arg=d.arg,this.method="return",this.next="end"):d.type==="normal"&&u&&(this.next=u),y},finish:function(d){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.finallyLoc===d)return this.complete(p.completion,p.afterLoc),f(p),y}},catch:function(d){for(var u=this.tryEntries.length-1;u>=0;--u){var p=this.tryEntries[u];if(p.tryLoc===d){var _=p.completion;if(_.type==="throw"){var v=_.arg;f(p)}return v}}throw new Error("illegal catch attempt")},delegateYield:function(d,u,p){return this.delegate={iterator:C(d),resultName:u,nextLoc:p},this.method==="next"&&(this.arg=void 0),y}},r}function Pe(r,e,t,n,i,a,o){try{var s=r[a](o),c=s.value}catch(l){t(l);return}s.done?e(c):Promise.resolve(c).then(n,i)}function W(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function o(c){Pe(a,n,i,o,s,"next",c)}function s(c){Pe(a,n,i,o,s,"throw",c)}o(void 0)})}}function Ee(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function et(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Ae(n.key),n)}}function _e(r,e,t){return e&&et(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ne(r,e,t){return e=Ae(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function tt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Y(r,e)}function Q(r){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(r)}function Y(r,e){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Y(r,e)}function Te(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function re(r,e,t){return Te()?re=Reflect.construct.bind():re=function(i,a,o){var s=[null];s.push.apply(s,a);var c=Function.bind.apply(i,s),l=new c;return o&&Y(l,o.prototype),l},re.apply(null,arguments)}function nt(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function pe(r){var e=typeof Map=="function"?new Map:void 0;return pe=function(n){if(n===null||!nt(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return re(n,arguments,Q(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Y(i,n)},pe(r)}function ie(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function rt(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ie(r)}function it(r){var e=Te();return function(){var n=Q(r),i;if(e){var a=Q(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rt(this,i)}}function at(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Ae(r){var e=at(r,"string");return typeof e=="symbol"?e:String(e)}var Le=typeof global<"u"&&{}.toString.call(global)==="[object global]";function Ce(r,e){return r.indexOf(e.toLowerCase())===0?r:"".concat(e.toLowerCase()).concat(r.substr(0,1).toUpperCase()).concat(r.substr(1))}function ot(r){return!!(r&&r.nodeType===1&&"nodeName"in r&&r.ownerDocument&&r.ownerDocument.defaultView)}function st(r){return!isNaN(parseFloat(r))&&isFinite(r)&&Math.floor(r)==r}function B(r){return/^(https?:)?\/\/((((player|www)\.)?vimeo\.com)|((player\.)?[a-zA-Z0-9-]+\.(videoji\.(hk|cn)|vimeo\.work)))(?=$|\/)/.test(r)}function Me(r){var e=/^https:\/\/player\.((vimeo\.com)|([a-zA-Z0-9-]+\.(videoji\.(hk|cn)|vimeo\.work)))\/video\/\d+/;return e.test(r)}function lt(r){for(var e=(r||"").match(/^(?:https?:)?(?:\/\/)?([^/?]+)/),t=(e&&e[1]||"").replace("player.",""),n=[".videoji.hk",".vimeo.work",".videoji.cn"],i=0,a=n;i<a.length;i++){var o=a[i];if(t.endsWith(o))return t}return"vimeo.com"}function Ie(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.id,t=r.url,n=e||t;if(!n)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(st(n))return"https://vimeo.com/".concat(n);if(B(n))return n.replace("http:","https:");throw e?new TypeError("“".concat(e,"” is not a valid video id.")):new TypeError("“".concat(n,"” is not a vimeo.com url."))}var qe=function(e,t,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"addEventListener",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"removeEventListener",o=typeof t=="string"?[t]:t;return o.forEach(function(s){e[i](s,n)}),{cancel:function(){return o.forEach(function(c){return e[a](c,n)})}}},ct=typeof Array.prototype.indexOf<"u",ut=typeof window<"u"&&typeof window.postMessage<"u";if(!Le&&(!ct||!ut))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var G=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dt(r,e){return e={exports:{}},r(e,e.exports),e.exports}/*!
 * weakmap-polyfill v2.0.4 - ECMAScript6 WeakMap polyfill
 * https://github.com/polygonplanet/weakmap-polyfill
 * Copyright (c) 2015-2021 polygonplanet <polygon.planet.aqua@gmail.com>
 * @license MIT
 */(function(r){if(r.WeakMap)return;var e=Object.prototype.hasOwnProperty,t=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{value:1}).x===1}catch{}}(),n=function(a,o,s){t?Object.defineProperty(a,o,{configurable:!0,writable:!0,value:s}):a[o]=s};r.WeakMap=function(){function a(){if(this===void 0)throw new TypeError("Constructor WeakMap requires 'new'");if(n(this,"_id",s("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}n(a.prototype,"delete",function(l){if(o(this,"delete"),!i(l))return!1;var k=l[this._id];return k&&k[0]===l?(delete l[this._id],!0):!1}),n(a.prototype,"get",function(l){if(o(this,"get"),!!i(l)){var k=l[this._id];if(k&&k[0]===l)return k[1]}}),n(a.prototype,"has",function(l){if(o(this,"has"),!i(l))return!1;var k=l[this._id];return!!(k&&k[0]===l)}),n(a.prototype,"set",function(l,k){if(o(this,"set"),!i(l))throw new TypeError("Invalid value used as weak map key");var y=l[this._id];return y&&y[0]===l?(y[1]=k,this):(n(l,this._id,[l,k]),this)});function o(l,k){if(!i(l)||!e.call(l,"_id"))throw new TypeError(k+" method called on incompatible receiver "+typeof l)}function s(l){return l+"_"+c()+"."+c()}function c(){return Math.random().toString().substring(2)}return n(a,"_polyfill",!0),a}();function i(a){return Object(a)===a}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:G);var $=dt(function(r){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(t,n,i){n[t]=n[t]||i(),r.exports&&(r.exports=n[t])})("Promise",G,function(){var t,n,i,a=Object.prototype.toString,o=typeof setImmediate<"u"?function(h){return setImmediate(h)}:setTimeout;try{Object.defineProperty({},"x",{}),t=function(h,m,b,E){return Object.defineProperty(h,m,{value:b,writable:!0,configurable:E!==!1})}}catch{t=function(m,b,E){return m[b]=E,m}}i=function(){var h,m,b;function E(A,f){this.fn=A,this.self=f,this.next=void 0}return{add:function(f,q){b=new E(f,q),m?m.next=b:h=b,m=b,b=void 0},drain:function(){var f=h;for(h=m=n=void 0;f;)f.fn.call(f.self),f=f.next}}}();function s(g,h){i.add(g,h),n||(n=o(i.drain))}function c(g){var h,m=typeof g;return g!=null&&(m=="object"||m=="function")&&(h=g.then),typeof h=="function"?h:!1}function l(){for(var g=0;g<this.chain.length;g++)k(this,this.state===1?this.chain[g].success:this.chain[g].failure,this.chain[g]);this.chain.length=0}function k(g,h,m){var b,E;try{h===!1?m.reject(g.msg):(h===!0?b=g.msg:b=h.call(void 0,g.msg),b===m.promise?m.reject(TypeError("Promise-chain cycle")):(E=c(b))?E.call(b,m.resolve,m.reject):m.resolve(b))}catch(A){m.reject(A)}}function y(g){var h,m=this;if(!m.triggered){m.triggered=!0,m.def&&(m=m.def);try{(h=c(g))?s(function(){var b=new w(m);try{h.call(g,function(){y.apply(b,arguments)},function(){P.apply(b,arguments)})}catch(E){P.call(b,E)}}):(m.msg=g,m.state=1,m.chain.length>0&&s(l,m))}catch(b){P.call(new w(m),b)}}}function P(g){var h=this;h.triggered||(h.triggered=!0,h.def&&(h=h.def),h.msg=g,h.state=2,h.chain.length>0&&s(l,h))}function S(g,h,m,b){for(var E=0;E<h.length;E++)(function(f){g.resolve(h[f]).then(function(C){m(f,C)},b)})(E)}function w(g){this.def=g,this.triggered=!1}function I(g){this.promise=g,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function L(g){if(typeof g!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var h=new I(this);this.then=function(b,E){var A={success:typeof b=="function"?b:!0,failure:typeof E=="function"?E:!1};return A.promise=new this.constructor(function(q,C){if(typeof q!="function"||typeof C!="function")throw TypeError("Not a function");A.resolve=q,A.reject=C}),h.chain.push(A),h.state!==0&&s(l,h),A.promise},this.catch=function(b){return this.then(void 0,b)};try{g.call(void 0,function(b){y.call(h,b)},function(b){P.call(h,b)})}catch(m){P.call(h,m)}}var O=t({},"constructor",L,!1);return L.prototype=O,t(O,"__NPO__",0,!1),t(L,"resolve",function(h){var m=this;return h&&typeof h=="object"&&h.__NPO__===1?h:new m(function(E,A){if(typeof E!="function"||typeof A!="function")throw TypeError("Not a function");E(h)})}),t(L,"reject",function(h){return new this(function(b,E){if(typeof b!="function"||typeof E!="function")throw TypeError("Not a function");E(h)})}),t(L,"all",function(h){var m=this;return a.call(h)!="[object Array]"?m.reject(TypeError("Not an array")):h.length===0?m.resolve([]):new m(function(E,A){if(typeof E!="function"||typeof A!="function")throw TypeError("Not a function");var f=h.length,q=Array(f),C=0;S(m,h,function(d,u){q[d]=u,++C===f&&E(q)},A)})}),t(L,"race",function(h){var m=this;return a.call(h)!="[object Array]"?m.reject(TypeError("Not an array")):new m(function(E,A){if(typeof E!="function"||typeof A!="function")throw TypeError("Not a function");S(m,h,function(q,C){E(C)},A)})}),L})}),F=new WeakMap;function Z(r,e,t){var n=F.get(r.element)||{};e in n||(n[e]=[]),n[e].push(t),F.set(r.element,n)}function ae(r,e){var t=F.get(r.element)||{};return t[e]||[]}function oe(r,e,t){var n=F.get(r.element)||{};if(!n[e])return!0;if(!t)return n[e]=[],F.set(r.element,n),!0;var i=n[e].indexOf(t);return i!==-1&&n[e].splice(i,1),F.set(r.element,n),n[e]&&n[e].length===0}function ft(r,e){var t=ae(r,e);if(t.length<1)return!1;var n=t.shift();return oe(r,e,n),n}function pt(r,e){var t=F.get(r);F.set(e,t),F.delete(r)}function se(r){if(typeof r=="string")try{r=JSON.parse(r)}catch(e){return console.warn(e),{}}return r}function V(r,e,t){if(!(!r.element.contentWindow||!r.element.contentWindow.postMessage)){var n={method:e};t!==void 0&&(n.value=t);var i=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));i>=8&&i<10&&(n=JSON.stringify(n)),r.element.contentWindow.postMessage(n,r.origin)}}function ht(r,e){e=se(e);var t=[],n;if(e.event){if(e.event==="error"){var i=ae(r,e.data.method);i.forEach(function(o){var s=new Error(e.data.message);s.name=e.data.name,o.reject(s),oe(r,e.data.method,o)})}t=ae(r,"event:".concat(e.event)),n=e.data}else if(e.method){var a=ft(r,e.method);a&&(t.push(a),n=e.value)}t.forEach(function(o){try{if(typeof o=="function"){o.call(r,n);return}o.resolve(n)}catch{}})}var mt=["airplay","audio_tracks","audiotrack","autopause","autoplay","background","byline","cc","chapter_id","chapters","chromecast","color","colors","controls","dnt","end_time","fullscreen","height","id","initial_quality","interactive_params","keyboard","loop","maxheight","max_quality","maxwidth","min_quality","muted","play_button_position","playsinline","portrait","preload","progress_bar","quality","quality_selector","responsive","skipping_forward","speed","start_time","texttrack","thumbnail_id","title","transcript","transparent","unmute_button","url","vimeo_logo","volume","watch_full_video","width"];function Oe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mt.reduce(function(t,n){var i=r.getAttribute("data-vimeo-".concat(n));return(i||i==="")&&(t[n]=i===""?1:i),t},e)}function he(r,e){var t=r.html;if(!e)throw new TypeError("An element must be provided");if(e.getAttribute("data-vimeo-initialized")!==null)return e.querySelector("iframe");var n=document.createElement("div");return n.innerHTML=t,e.appendChild(n.firstChild),e.setAttribute("data-vimeo-initialized","true"),e.querySelector("iframe")}function xe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;return new Promise(function(n,i){if(!B(r))throw new TypeError("“".concat(r,"” is not a vimeo.com url."));var a=lt(r),o="https://".concat(a,"/api/oembed.json?url=").concat(encodeURIComponent(r));for(var s in e)e.hasOwnProperty(s)&&(o+="&".concat(s,"=").concat(encodeURIComponent(e[s])));var c="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;c.open("GET",o,!0),c.onload=function(){if(c.status===404){i(new Error("“".concat(r,"” was not found.")));return}if(c.status===403){i(new Error("“".concat(r,"” is not embeddable.")));return}try{var l=JSON.parse(c.responseText);if(l.domain_status_code===403){he(l,t),i(new Error("“".concat(r,"” is not embeddable.")));return}n(l)}catch(k){i(k)}},c.onerror=function(){var l=c.status?" (".concat(c.status,")"):"";i(new Error("There was an error fetching the embed code from Vimeo".concat(l,".")))},c.send()})}function gt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=[].slice.call(r.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),t=function(i){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(i))};e.forEach(function(n){try{if(n.getAttribute("data-vimeo-defer")!==null)return;var i=Oe(n),a=Ie(i);xe(a,i,n).then(function(o){return he(o,n)}).catch(t)}catch(o){t(o)}})}function vt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var e=function(n){if(B(n.origin)&&!(!n.data||n.data.event!=="spacechange")){for(var i=r.querySelectorAll("iframe"),a=0;a<i.length;a++)if(i[a].contentWindow===n.source){var o=i[a].parentElement;o.style.paddingBottom="".concat(n.data.data[0].bottom,"px");break}}};window.addEventListener("message",e)}}function yt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var e=function(n){if(B(n.origin)){var i=se(n.data);if(!(!i||i.event!=="ready"))for(var a=r.querySelectorAll("iframe"),o=0;o<a.length;o++){var s=a[o],c=s.contentWindow===n.source;if(Me(s.src)&&c){var l=new ge(s);l.callMethod("appendVideoMetadata",window.location.href)}}}};window.addEventListener("message",e)}}function wt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var e=function(i){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(i))},t=function(i){if(B(i.origin)){var a=se(i.data);if(!(!a||a.event!=="ready"))for(var o=r.querySelectorAll("iframe"),s=function(){var k=o[c],y=k.contentWindow===i.source;if(Me(k.src)&&y){var P=new ge(k);P.getVideoId().then(function(S){var w=new RegExp("[?&]vimeo_t_".concat(S,"=([^&#]*)")).exec(window.location.href);if(w&&w[1]){var I=decodeURI(w[1]);P.setCurrentTime(I)}}).catch(e)}},c=0;c<o.length;c++)s()}};window.addEventListener("message",t)}}function bt(){var r=function(){for(var n,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,o=i.length,s={};a<o;a++)if(n=i[a],n&&n[1]in document){for(a=0;a<n.length;a++)s[i[0][a]]=n[a];return s}return!1}(),e={fullscreenchange:r.fullscreenchange,fullscreenerror:r.fullscreenerror},t={request:function(i){return new Promise(function(a,o){var s=function l(){t.off("fullscreenchange",l),a()};t.on("fullscreenchange",s),i=i||document.documentElement;var c=i[r.requestFullscreen]();c instanceof Promise&&c.then(s).catch(o)})},exit:function(){return new Promise(function(i,a){if(!t.isFullscreen){i();return}var o=function c(){t.off("fullscreenchange",c),i()};t.on("fullscreenchange",o);var s=document[r.exitFullscreen]();s instanceof Promise&&s.then(o).catch(a)})},on:function(i,a){var o=e[i];o&&document.addEventListener(o,a)},off:function(i,a){var o=e[i];o&&document.removeEventListener(o,a)}};return Object.defineProperties(t,{isFullscreen:{get:function(){return!!document[r.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!document[r.fullscreenEnabled]}}}),t}var kt={role:"viewer",autoPlayMuted:!0,allowedDrift:.3,maxAllowedDrift:1,minCheckInterval:.1,maxRateAdjustment:.2,maxTimeToCatchUp:1},St=function(r){tt(t,r);var e=it(t);function t(n,i){var a,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;return Ee(this,t),a=e.call(this),ne(ie(a),"logger",void 0),ne(ie(a),"speedAdjustment",0),ne(ie(a),"adjustSpeed",function(){var c=W(x().mark(function l(k,y){var P;return x().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(a.speedAdjustment!==y){w.next=2;break}return w.abrupt("return");case 2:return w.next=4,k.getPlaybackRate();case 4:return w.t0=w.sent,w.t1=a.speedAdjustment,w.t2=w.t0-w.t1,w.t3=y,P=w.t2+w.t3,a.log("New playbackRate:  ".concat(P)),w.next=12,k.setPlaybackRate(P);case 12:a.speedAdjustment=y;case 13:case"end":return w.stop()}},l)}));return function(l,k){return c.apply(this,arguments)}}()),a.logger=s,a.init(i,n,Se(Se({},kt),o)),a}return _e(t,[{key:"disconnect",value:function(){this.dispatchEvent(new Event("disconnect"))}},{key:"init",value:function(){var n=W(x().mark(function a(o,s,c){var l=this,k,y,P;return x().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.waitForTOReadyState(o,"open");case 2:if(c.role!=="viewer"){w.next=10;break}return w.next=5,this.updatePlayer(o,s,c);case 5:k=qe(o,"change",function(){return l.updatePlayer(o,s,c)}),y=this.maintainPlaybackPosition(o,s,c),this.addEventListener("disconnect",function(){y.cancel(),k.cancel()}),w.next=14;break;case 10:return w.next=12,this.updateTimingObject(o,s);case 12:P=qe(s,["seeked","play","pause","ratechange"],function(){return l.updateTimingObject(o,s)},"on","off"),this.addEventListener("disconnect",function(){return P.cancel()});case 14:case"end":return w.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"updateTimingObject",value:function(){var n=W(x().mark(function a(o,s){return x().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.t0=o,l.next=3,s.getCurrentTime();case 3:return l.t1=l.sent,l.next=6,s.getPaused();case 6:if(!l.sent){l.next=10;break}l.t2=0,l.next=13;break;case 10:return l.next=12,s.getPlaybackRate();case 12:l.t2=l.sent;case 13:l.t3=l.t2,l.t4={position:l.t1,velocity:l.t3},l.t0.update.call(l.t0,l.t4);case 16:case"end":return l.stop()}},a)}));function i(a,o){return n.apply(this,arguments)}return i}()},{key:"updatePlayer",value:function(){var n=W(x().mark(function a(o,s,c){var l,k,y;return x().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(l=o.query(),k=l.position,y=l.velocity,typeof k=="number"&&s.setCurrentTime(k),typeof y!="number"){S.next=25;break}if(y!==0){S.next=11;break}return S.next=6,s.getPaused();case 6:if(S.t0=S.sent,S.t0!==!1){S.next=9;break}s.pause();case 9:S.next=25;break;case 11:if(!(y>0)){S.next=25;break}return S.next=14,s.getPaused();case 14:if(S.t1=S.sent,S.t1!==!0){S.next=19;break}return S.next=18,s.play().catch(function(){var w=W(x().mark(function I(L){return x().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(L.name==="NotAllowedError"&&c.autoPlayMuted)){g.next=5;break}return g.next=3,s.setMuted(!0);case 3:return g.next=5,s.play().catch(function(h){return console.error("Couldn't play the video from TimingSrcConnector. Error:",h)});case 5:case"end":return g.stop()}},I)}));return function(I){return w.apply(this,arguments)}}());case 18:this.updatePlayer(o,s,c);case 19:return S.next=21,s.getPlaybackRate();case 21:if(S.t2=S.sent,S.t3=y,S.t2===S.t3){S.next=25;break}s.setPlaybackRate(y);case 25:case"end":return S.stop()}},a,this)}));function i(a,o,s){return n.apply(this,arguments)}return i}()},{key:"maintainPlaybackPosition",value:function(i,a,o){var s=this,c=o.allowedDrift,l=o.maxAllowedDrift,k=o.minCheckInterval,y=o.maxRateAdjustment,P=o.maxTimeToCatchUp,S=Math.min(P,Math.max(k,l))*1e3,w=function(){var L=W(x().mark(function O(){var g,h,m,b,E;return x().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(f.t0=i.query().velocity===0,f.t0){f.next=6;break}return f.next=4,a.getPaused();case 4:f.t1=f.sent,f.t0=f.t1===!0;case 6:if(!f.t0){f.next=8;break}return f.abrupt("return");case 8:return f.t2=i.query().position,f.next=11,a.getCurrentTime();case 11:if(f.t3=f.sent,g=f.t2-f.t3,h=Math.abs(g),s.log("Drift: ".concat(g)),!(h>l)){f.next=22;break}return f.next=18,s.adjustSpeed(a,0);case 18:a.setCurrentTime(i.query().position),s.log("Resync by currentTime"),f.next=29;break;case 22:if(!(h>c)){f.next=29;break}return m=h/P,b=y,E=m<b?(b-m)/2:b,f.next=28,s.adjustSpeed(a,E*Math.sign(g));case 28:s.log("Resync by playbackRate");case 29:case"end":return f.stop()}},O)}));return function(){return L.apply(this,arguments)}}(),I=setInterval(function(){return w()},S);return{cancel:function(){return clearInterval(I)}}}},{key:"log",value:function(i){var a;(a=this.logger)===null||a===void 0||a.call(this,"TimingSrcConnector: ".concat(i))}},{key:"waitForTOReadyState",value:function(i,a){return new Promise(function(o){var s=function c(){i.readyState===a?o():i.addEventListener("readystatechange",c,{once:!0})};s()})}}]),t}(pe(EventTarget)),U=new WeakMap,me=new WeakMap,R={},ge=function(){function r(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ee(this,r),window.jQuery&&e instanceof jQuery&&(e.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),e=e[0]),typeof document<"u"&&typeof e=="string"&&(e=document.getElementById(e)),!ot(e))throw new TypeError("You must pass either a valid element or a valid id.");if(e.nodeName!=="IFRAME"){var i=e.querySelector("iframe");i&&(e=i)}if(e.nodeName==="IFRAME"&&!B(e.getAttribute("src")||""))throw new Error("The player element passed isn’t a Vimeo embed.");if(U.has(e))return U.get(e);this._window=e.ownerDocument.defaultView,this.element=e,this.origin="*";var a=new $(function(s,c){if(t._onMessage=function(y){if(!(!B(y.origin)||t.element.contentWindow!==y.source)){t.origin==="*"&&(t.origin=y.origin);var P=se(y.data),S=P&&P.event==="error",w=S&&P.data&&P.data.method==="ready";if(w){var I=new Error(P.data.message);I.name=P.data.name,c(I);return}var L=P&&P.event==="ready",O=P&&P.method==="ping";if(L||O){t.element.setAttribute("data-ready","true"),s();return}ht(t,P)}},t._window.addEventListener("message",t._onMessage),t.element.nodeName!=="IFRAME"){var l=Oe(e,n),k=Ie(l);xe(k,l,e).then(function(y){var P=he(y,e);return t.element=P,t._originalElement=e,pt(e,P),U.set(t.element,t),y}).catch(c)}});if(me.set(this,a),U.set(this.element,this),this.element.nodeName==="IFRAME"&&V(this,"ping"),R.isEnabled){var o=function(){return R.exit()};this.fullscreenchangeHandler=function(){R.isFullscreen?Z(t,"event:exitFullscreen",o):oe(t,"event:exitFullscreen",o),t.ready().then(function(){V(t,"fullscreenchange",R.isFullscreen)})},R.on("fullscreenchange",this.fullscreenchangeHandler)}return this}return _e(r,[{key:"callMethod",value:function(t){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(t==null)throw new TypeError("You must pass a method name.");return new $(function(s,c){return n.ready().then(function(){Z(n,t,{resolve:s,reject:c}),V(n,t,a)}).catch(c)})}},{key:"get",value:function(t){var n=this;return new $(function(i,a){return t=Ce(t,"get"),n.ready().then(function(){Z(n,t,{resolve:i,reject:a}),V(n,t)}).catch(a)})}},{key:"set",value:function(t,n){var i=this;return new $(function(a,o){if(t=Ce(t,"set"),n==null)throw new TypeError("There must be a value to set.");return i.ready().then(function(){Z(i,t,{resolve:a,reject:o}),V(i,t,n)}).catch(o)})}},{key:"on",value:function(t,n){if(!t)throw new TypeError("You must pass an event name.");if(!n)throw new TypeError("You must pass a callback function.");if(typeof n!="function")throw new TypeError("The callback must be a function.");var i=ae(this,"event:".concat(t));i.length===0&&this.callMethod("addEventListener",t).catch(function(){}),Z(this,"event:".concat(t),n)}},{key:"off",value:function(t,n){if(!t)throw new TypeError("You must pass an event name.");if(n&&typeof n!="function")throw new TypeError("The callback must be a function.");var i=oe(this,"event:".concat(t),n);i&&this.callMethod("removeEventListener",t).catch(function(a){})}},{key:"loadVideo",value:function(t){return this.callMethod("loadVideo",t)}},{key:"ready",value:function(){var t=me.get(this)||new $(function(n,i){i(new Error("Unknown player. Probably unloaded."))});return $.resolve(t)}},{key:"addCuePoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.callMethod("addCuePoint",{time:t,data:n})}},{key:"removeCuePoint",value:function(t){return this.callMethod("removeCuePoint",t)}},{key:"enableTextTrack",value:function(t,n){if(!t)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:t,kind:n})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return R.isEnabled?R.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return R.isEnabled?R.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return R.isEnabled?$.resolve(R.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"remotePlaybackPrompt",value:function(){return this.callMethod("remotePlaybackPrompt")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var t=this;return new $(function(n){if(me.delete(t),U.delete(t.element),t._originalElement&&(U.delete(t._originalElement),t._originalElement.removeAttribute("data-vimeo-initialized")),t.element&&t.element.nodeName==="IFRAME"&&t.element.parentNode&&(t.element.parentNode.parentNode&&t._originalElement&&t._originalElement!==t.element.parentNode?t.element.parentNode.parentNode.removeChild(t.element.parentNode):t.element.parentNode.removeChild(t.element)),t.element&&t.element.nodeName==="DIV"&&t.element.parentNode){t.element.removeAttribute("data-vimeo-initialized");var i=t.element.querySelector("iframe");i&&i.parentNode&&(i.parentNode.parentNode&&t._originalElement&&t._originalElement!==i.parentNode?i.parentNode.parentNode.removeChild(i.parentNode):i.parentNode.removeChild(i))}t._window.removeEventListener("message",t._onMessage),R.isEnabled&&R.off("fullscreenchange",t.fullscreenchangeHandler),n()})}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(t){return this.set("autopause",t)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(t){return this.set("cameraProps",t)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"getColors",value:function(){return $.all([this.get("colorOne"),this.get("colorTwo"),this.get("colorThree"),this.get("colorFour")])}},{key:"setColor",value:function(t){return this.set("color",t)}},{key:"setColors",value:function(t){if(!Array.isArray(t))return new $(function(a,o){return o(new TypeError("Argument must be an array."))});var n=new $(function(a){return a(null)}),i=[t[0]?this.set("colorOne",t[0]):n,t[1]?this.set("colorTwo",t[1]):n,t[2]?this.set("colorThree",t[2]):n,t[3]?this.set("colorFour",t[3]):n];return $.all(i)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(t){return this.set("currentTime",t)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(t){return this.set("loop",t)}},{key:"setMuted",value:function(t){return this.set("muted",t)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(t){return this.set("playbackRate",t)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(t){return this.set("quality",t)}},{key:"getRemotePlaybackAvailability",value:function(){return this.get("remotePlaybackAvailability")}},{key:"getRemotePlaybackState",value:function(){return this.get("remotePlaybackState")}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(t){return this.set("volume",t)}},{key:"setTimingSrc",value:function(){var e=W(x().mark(function n(i,a){var o=this,s;return x().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(i){l.next=2;break}throw new TypeError("A Timing Object must be provided.");case 2:return l.next=4,this.ready();case 4:return s=new St(this,i,a),V(this,"notifyTimingObjectConnect"),s.addEventListener("disconnect",function(){return V(o,"notifyTimingObjectDisconnect")}),l.abrupt("return",s);case 8:case"end":return l.stop()}},n,this)}));function t(n,i){return e.apply(this,arguments)}return t}()}]),r}();Le||(R=bt(),gt(),vt(),yt(),wt());const Pt="menu-video",Et="1.0.0",J=(r,...e)=>console.log(`[SW-MENU-VIDEO] ${r}`,...e);function _t(){const r=document.querySelectorAll("[data-name]"),e=document.querySelectorAll("[data-video-for-name]");if(r.length===0||e.length===0){J("Éléments nécessaires non trouvés (liens avec [data-name] ou vidéos avec [data-video-for-name]). Module inactif.");return}J(`Initialisation pour ${r.length} activités et ${e.length} vidéos.`);const t=new Map;e.forEach(n=>{const i=n.querySelector("iframe");if(i){const a=n.dataset.videoForName,o=new ge(i);t.set(a,o),o.setVolume(.1),o.pause()}n.style.display="none"}),e.length>0&&(e[0].style.display="block"),r.forEach(n=>{n.addEventListener("mouseenter",()=>{const i=n.dataset.name;J(`Survol de : ${i}`),t.forEach((s,c)=>{c!==i&&s.pause()}),e.forEach(s=>{s.style.display="none"});const a=document.querySelector(`[data-video-for-name="${i}"]`),o=t.get(i);a&&o?(a.style.display="block",o.play().catch(s=>{J(`Erreur de lecture automatique pour ${i}:`,s.name)})):J(`Vidéo correspondante non trouvée pour : ${i}`)})}),console.log(`🎬 ${Pt}.js v${Et} chargé et écouteurs actifs.`)}console.log("🚀 main_gsap.js v3.0.1 chargé");function Tt(){console.log("✅ GSAP est prêt. Initialisation des modules...");try{je(),Ne(),We(),Be(),Ke(),_t(),window.location.pathname.includes("/reservation")&&(console.log("-> Page Réservation détectée via l'URL. Chargement du module..."),Ye(),console.log("✅ Module Réservation chargé et initialisé.")),Ze(),document.querySelector(".salles_privatisable_holder")&&(console.log("-> Élément .salles_privatisable_holder détecté. Initialisation du module."),Je()),document.querySelector('[data-attribute="preselect-booking-button"]')&&(console.log("-> Bouton de présélection détecté. Initialisation du module."),Xe()),console.log("✨ Tous les modules principaux ont été initialisés."),ce()}catch(r){console.error("❌ Erreur lors de l'initialisation des modules. Forçage du masquage du loader.",r),ce()}}function At(){Re();let r=0;const e=100,n=setInterval(()=>{window.gsap?(clearInterval(n),Tt()):(r++,r>e&&(clearInterval(n),console.error("GSAP n'a pas pu être chargé après 10 secondes. Annulation de l'initialisation des modules."),ce()))},100)}window.Webflow=window.Webflow||[],window.Webflow.push(function(){console.log("🚀 Webflow est prêt, lancement de l'attente de GSAP."),At()}),window.addEventListener("load",()=>{console.log("🎬 La page est entièrement chargée. Forçage de l'état des cartes de centre."),Ue()})})();
