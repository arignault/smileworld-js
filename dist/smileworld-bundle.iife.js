(function(){"use strict";console.log("ðŸš€ loading-screen.js v1.3.0 chargÃ©");function W(){return new Promise(t=>{if(!window.gsap){console.error("GSAP n'est pas chargÃ©."),t();return}const e=document.querySelector(".loadingscreen");if(!e){console.warn("Ã‰lÃ©ment .loadingscreen introuvable. L'animation ne peut pas dÃ©marrer."),t();return}window.gsap.timeline({onComplete:()=>{console.log("Animation du loader terminÃ©e."),e&&(e.style.display="none"),t()}}).to(e,{autoAlpha:0,duration:.5,delay:1})})}function D(){console.log("ðŸŸ¢ Application prÃªte, demande de masquage de l'Ã©cran de chargement.")}function R(){const t=document.querySelector(".loadingscreen");t&&window.gsap.to(t,{opacity:0,duration:.5,onComplete:()=>{window.gsap.set(t,{display:"none"})}})}console.log("ðŸš€ text-animation.js v2.1.0 chargÃ©");function O(){const t=document.querySelector(".span_mover");if(t)try{let n=function(){if(i)return;i=!0;const s=gsap.timeline({onComplete:()=>{i=!1,gsap.to(t,{y:e.positions.start,duration:e.duration,ease:e.ease,onComplete:()=>{setTimeout(n,e.cycleDelay*1e3)}})}}),o=[e.positions.start,e.positions.middle,e.positions.end];for(let a=0;a<o.length;a++)s.to(t,{y:o[a],duration:e.duration,ease:e.ease}),a<o.length-1&&s.to({},{duration:e.pauseDuration});s.play()};const e={duration:.6,ease:"back.out(1.7)",pauseDuration:1.5,cycleDelay:.5,positions:{start:"0%",middle:"-34%",end:"-68%"}};let i=!1;n(),window.addEventListener("beforeunload",()=>{gsap.killTweensOf(t)})}catch(e){console.error("Erreur dans l'animation de texte:",e)}}let y=!1;async function P(t){if(!t||!t.classList.contains("is-open"))return;y=!0;const e=t.querySelector(".faq_respond"),i=t.querySelector(".svg-holder");t.classList.remove("is-open");const n=window.gsap.timeline({onComplete:()=>{e&&(e.style.display="none"),y=!1}});i&&n.to(i,{rotation:0,duration:.25,ease:"power2.inOut"},0),e&&(n.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in"},0),n.to(e,{height:0,duration:.4,ease:"back.in(1.7)"},0)),await n}async function F(t){if(!t||t.classList.contains("is-open"))return;y=!0;const e=t.querySelector(".faq_respond"),i=t.querySelector(".svg-holder");t.classList.add("is-open");const n=window.gsap.timeline({onComplete:()=>{y=!1}});if(e){window.gsap.set(e,{display:"block",opacity:0,y:-20,height:0}),window.getComputedStyle(e).height,window.gsap.set(e,{height:"auto"});const s=e.scrollHeight;window.gsap.set(e,{height:0}),n.to(e,{height:s,duration:.6,ease:"elastic.out(1.2, 0.5)"},0),n.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out"},"<0.05")}i&&n.to(i,{rotation:90,duration:.25,ease:"back.out(1.7)"},0),await n}async function N(t){if(y)return;if(t.classList.contains("is-open"))await P(t);else{const i=document.querySelectorAll(".faq_item.is-open");await Promise.all(Array.from(i).map(n=>P(n))),await F(t)}}function z(){const t=document.querySelectorAll(".faq_item");t.length!==0&&t.forEach(e=>{e&&(e.classList.remove("is-open"),e.querySelector(".faq_respond")&&window.gsap.set(e.querySelector(".faq_respond"),{height:0,opacity:0,display:"none"}),e.querySelector(".svg-holder")&&window.gsap.set(e.querySelector(".svg-holder"),{rotation:0}),!e.dataset.faqInitialized&&(e.dataset.faqInitialized="true",e.addEventListener("click",i=>{i.target.closest(".faq_respond a, .faq_respond button")||(i.preventDefault(),N(e))})))})}console.log("ðŸš€ centre-card.js v8.0.0 chargÃ© â€“ Fusion animation marquee");const p={CARD:".centre-card_wrapper.effect-cartoon-shadow",CLICKABLE_WRAP:'.clickable_wrap[data-attribute="data-card-toggle"]',TOGGLE_ELEMENTS:[".centre-card_scroll_wrapper",".centre-card_list",".centre-card_button-holder",".tag_holder_wrapper"],ARROW:".svg-holder.arrow",INTERNAL_LINKS:".centre-card_button-holder a, .centre-card_button-holder button",MARQUEE_COMPONENT:".tag_wrapper_gsap_loop:not(.w-dyn-list):not(.w-dyn-items)",MARQUEE_LIST_CONTAINER:".tag_wrapper_gsap_loop.w-dyn-list",MARQUEE_ITEMS_LIST:".w-dyn-items"},q=new WeakSet;let w=!1;const m={maxOffset:.1875,defaultVerticalOffset:.1875,shadowColor:"var(--colors--black)",scaleAmount:1.05,scaleDuration:.15,scaleEase:"elastic.out(1, 0.3)"};async function x(t){if(!t||!t.classList.contains("is-open"))return;const e=t.querySelectorAll(p.TOGGLE_ELEMENTS.join(",")),i=t.querySelector(p.ARROW),n=t.querySelector(".centre-card_scroll_wrapper");t.classList.remove("is-open");const s=window.gsap.timeline({onStart:()=>{n&&window.gsap.set(n,{height:"10rem"})},onComplete:()=>{window.gsap.set(e,{display:"none"}),n&&window.gsap.set(n,{height:0})}});s.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in",stagger:{each:.02,from:"start"}},0),i&&s.to(i,{rotation:0,duration:.25,ease:"power2.inOut"},0),n&&s.to(n,{height:0,duration:.4,ease:"back.in(1.7)"},0),await s,t.marqueeTween&&t.marqueeTween.play()}async function H(t){if(!t||t.classList.contains("is-open"))return;t.classList.add("is-open"),t.marqueeTween&&t.marqueeTween.pause();const e=t.querySelectorAll(p.TOGGLE_ELEMENTS.join(",")),i=t.querySelector(p.ARROW),n=t.querySelector(".centre-card_scroll_wrapper");e.forEach(o=>{window.gsap.set(o,{display:o.dataset.originalDisplay||"block",opacity:0,y:-20})});const s=window.gsap.timeline({onStart:()=>{n&&window.gsap.set(n,{height:0})}});n&&s.to(n,{height:"10rem",duration:.6,ease:"elastic.out(1.2, 0.5)"},0),i&&s.to(i,{rotation:90,duration:.25,ease:"back.out(1.7)"},"<"),s.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out",stagger:{each:.035,from:"start"}},"<0.05"),await s}async function G(t){if(!w){w=!0;try{if(t.classList.contains("is-open"))await x(t);else{const i=document.querySelectorAll(`${p.CARD}.is-open`);await Promise.all(Array.from(i).map(n=>x(n))),await H(t)}}finally{w=!1}}}function U(t,e){const i=e.getBoundingClientRect();return{x:-((t.clientX-i.left)/i.width*2-1)}}function E(t,e){if(!e||e.classList.contains("is-open"))return;const n=U(t,e).x*m.maxOffset;e.style.boxShadow=`${n}rem ${m.defaultVerticalOffset}rem 0 0 ${m.shadowColor}`}function j(t,e){!e||e.classList.contains("is-open")||(window.gsap.to(e,{scale:m.scaleAmount,duration:m.scaleDuration,ease:m.scaleEase,overwrite:!0}),e.marqueeTween&&gsap.to(e.marqueeTween,{timeScale:.2,duration:.5}),E(t,e))}function V(t){!t||t.classList.contains("is-open")||(t.style.boxShadow=`0 ${m.defaultVerticalOffset}rem 0 0 ${m.shadowColor}`,window.gsap.to(t,{scale:1,duration:m.scaleDuration,ease:m.scaleEase,overwrite:!0}),t.marqueeTween&&gsap.to(t.marqueeTween,{timeScale:1,duration:.5}))}function K(t){const e=t.querySelector(p.MARQUEE_COMPONENT);if(!e)return;const i=e.querySelector(p.MARQUEE_LIST_CONTAINER),n=i?i.querySelector(p.MARQUEE_ITEMS_LIST):null;if(!n||n.children.length<=1||i.dataset.marqueeInitialized)return;i.dataset.marqueeInitialized="true",e.style.overflow="hidden",i.style.display="flex",i.style.flexWrap="nowrap";const s=l=>{l.style.display="flex",l.style.flexWrap="nowrap",l.style.width="auto",l.style.flexShrink="0"};s(n);const o=n.cloneNode(!0);s(o),i.appendChild(o);const r=n.offsetWidth/50;t.marqueeTween=gsap.to([n,o],{xPercent:-100,duration:r,ease:"none",repeat:-1,modifiers:{xPercent:gsap.utils.unitize(gsap.utils.wrap(-100,0))}})}function C(t){if(q.has(t))return;const e=t.parentElement.querySelector(p.CLICKABLE_WRAP);if(!e)return;const i=t.querySelectorAll(p.TOGGLE_ELEMENTS.join(","));i.forEach(s=>{s.dataset.originalDisplay=window.getComputedStyle(s).display}),window.gsap.set(i,{display:"none",opacity:0,y:-20});const n=s=>{s.target.closest(p.INTERNAL_LINKS)||(s.preventDefault(),s.stopPropagation(),G(t))};e.addEventListener("click",n),t.addEventListener("mousemove",s=>E(s,t)),t.addEventListener("mouseleave",()=>V(t)),t.addEventListener("mouseenter",s=>j(s,t)),q.add(t),K(t)}function Q(){document.querySelectorAll(p.CARD).forEach(C)}function T(t){if(!t)return;t.querySelectorAll(p.CARD).forEach(C)}console.log("ðŸš€ menu-desktop.js v15.0.0 chargÃ© - Initialisation explicite");class Z{constructor(){this.activePanel=null,this.isAnimating=!1,this.triggerSelector='[data-attribute^="nav-link-desktop-"]',this.wrapperSelector=".desktop_menu_wrapper",this.panelClassMap={parcs:".parc_menu_desktop",activites:".activites_menu_desktop",offres:".offres_menu_desktop"},this._addGlobalListener(),console.log('âœ… Gestionnaire de clic "StratÃ©gie Wrapper" est actif.')}_addGlobalListener(){document.body.addEventListener("click",e=>{if(this.isAnimating)return;const i=e.target.closest(this.triggerSelector),n=document.querySelector(this.wrapperSelector);if(this.activePanel&&!i&&!this.activePanel.contains(e.target)){this._closeAll();return}if(!i)return;if(e.preventDefault(),e.stopPropagation(),!n){console.error(`Wrapper introuvable avec le sÃ©lecteur: ${this.wrapperSelector}`);return}const s=i.getAttribute("data-attribute").replace("nav-link-desktop-",""),o=n.querySelector(this.panelClassMap[s]);if(!o){console.error(`Panneau cible pour la clÃ© "${s}" non trouvÃ© dans le wrapper.`);return}const a=this.activePanel===o,r=!this.activePanel;a?this._closeAll():r?this._openWrapperAndPanel(o):this._switchPanels(this.activePanel,o)})}_openWrapperAndPanel(e){const i=document.querySelector(this.wrapperSelector);this.isAnimating=!0,window.gsap.set(i,{display:"flex",opacity:0}),Object.values(this.panelClassMap).forEach(n=>{const s=i.querySelector(n);s&&window.gsap.set(s,{display:"none"})}),window.gsap.set(e,{display:"flex"}),window.gsap.to(i,{opacity:1,duration:.3,ease:"power2.out",onComplete:()=>{this.isAnimating=!1,this.activePanel=e,T(e)}})}_closeAll(){const e=document.querySelector(this.wrapperSelector);!this.activePanel||!e||(this.isAnimating=!0,window.gsap.to(e,{opacity:0,duration:.2,ease:"power1.in",onComplete:()=>{window.gsap.set(e,{display:"none"}),this.activePanel&&window.gsap.set(this.activePanel,{display:"none"}),this.activePanel=null,this.isAnimating=!1}}))}_switchPanels(e,i){this.isAnimating=!0;const n=window.gsap.timeline({onComplete:()=>{this.isAnimating=!1,this.activePanel=i,T(i)}});n.to(e,{opacity:0,duration:.15,onComplete:()=>window.gsap.set(e,{display:"none"})}),n.set(i,{display:"flex",opacity:0}),n.to(i,{opacity:1,duration:.15})}}function X(){new Z}function Y(){const t=document.querySelector("#hamburger-menu"),e=document.querySelector("#main-menu-mobile"),i=document.body,n=document.querySelector("#parcs-nav_button_mobile"),s=document.querySelector("#activites-nav_button_mobile"),o=document.querySelector("#formules-nav_button_mobile"),a=document.querySelector("#parc-menu-mobile"),r=document.querySelector("#activite-menu-mobile"),l=document.querySelector("#offres-menu-mobile"),d=document.querySelectorAll(".button-close"),u=document.querySelectorAll(".button-back-menu");let f=!1,b=0,g=window.gsap.timeline({paused:!0});const k=window.gsap.timeline({paused:!0});k.to(t,{rotation:90,duration:.4,ease:"elastic.out(1, 0.5)",transformOrigin:"center center"}),[e,a,r,l].forEach(c=>{c.style.display="none"});function I(){b=window.pageYOffset||document.documentElement.scrollTop,i.style.overflow="hidden",i.style.position="fixed",i.style.width="100%",i.style.top=`-${b}px`}function M(){i.style.overflow="",i.style.position="",i.style.width="",i.style.top="",window.scrollTo(0,b)}function $(){return window.gsap.timeline({paused:!0}).add(()=>{e.style.display="flex",[a,r,l].forEach(c=>{c.style.display="none"})},"openMainMenu").add(()=>{e.style.display="none",a.style.display="flex"},"openParcMenu").add(()=>{e.style.display="none",r.style.display="flex"},"openActiviteMenu").add(()=>{e.style.display="none",l.style.display="flex"},"openOffresMenu")}g=$();function _(c=null){[n,s,o,document.querySelector("#parcs-nav_button"),document.querySelector("#activites-nav_button"),document.querySelector("#formules-nav_button")].forEach(h=>{h&&(c&&h.id===c?h.classList.add("active"):h.classList.remove("active"))})}function v(c){c?k.play():k.reverse()}function ce(c){const h={"parcs-nav_button":a,"activites-nav_button":r,"formules-nav_button":l,"parcs-nav_button_mobile":a,"activites-nav_button_mobile":r,"formules-nav_button_mobile":l}[c];if(h){if(e.style.display="none",a.style.display="none",r.style.display="none",l.style.display="none",f&&h.style.display==="flex"){f=!1,M(),_(),v(!1);return}requestAnimationFrame(()=>{h.style.display="flex",f=!0,I(),_(c),v(!0)})}}function B(){g&&g.kill(),f=!1,[e,a,r,l].forEach(c=>{c.style.display="none"}),M(),_(),v(!1),g=$()}function de(){[a,r,l].forEach(c=>{c.style.display="none"}),e.style.display="flex",f=!0}function A(c){e.style.display="none",f=!0,c.style.display="flex"}t.addEventListener("click",()=>{f?B():([a,r,l].forEach(c=>{c.style.display="none"}),e.style.display="flex",f=!0,I(),v(!0))}),n.addEventListener("click",()=>A(a)),s.addEventListener("click",()=>A(r)),o.addEventListener("click",()=>A(l)),d.forEach(c=>{c.addEventListener("click",B)}),u.forEach(c=>{c.addEventListener("click",de)}),document.querySelectorAll("#parcs-nav_button, #activites-nav_button, #formules-nav_button, #parcs-nav_button_mobile, #activites-nav_button_mobile, #formules-nav_button_mobile").forEach(c=>{c.addEventListener("click",L=>{L.preventDefault(),ce(c.id)})})}function J(){console.group("--- Informations de DÃ©bogage ---"),console.log("Wrapper Menu Desktop:",document.querySelector(".desktop_menu_wrapper")),console.log("Boutons de menu:",{parcs:document.querySelector('[data-attribute="nav-link-desktop-parcs"]'),activites:document.querySelector('[data-attribute="nav-link-desktop-activites"]'),offres:document.querySelector('[data-attribute="nav-link-desktop-offres"]')}),console.log("Conteneurs de menu:",{parcs:document.querySelector(".parc_menu_desktop"),activites:document.querySelector(".activites_menu_desktop"),offres:document.querySelector(".offres_menu_desktop")}),console.groupEnd()}function ee(){window.location.hash==="#debug"&&(console.log("ðŸ› Mode de dÃ©bogage activÃ©."),J())}class te{constructor(){this.config={defaultVideoUrl:"https://player.vimeo.com/progressive_redirect/playback/1088767237/rendition/1080p/file.mp4?loc=external&signature=1d46b415bde9b315b01d645374b5f7319940ecff5995ac8ac213f847577f6536",ids:{initialContainer:"container-initial",filteredContainer:"container-filtre",hiddenMap:"hidden-map",initialActivitiesPane:"tab-pane-initial-activites",initialParksPane:"tab-pane-initial-parcs",filteredActivitiesPane:"tab-pane-filtre-activites",filteredParksPane:"tab-pane-filtre-parcs",initialActivitiesTabLink:"tab-link-initial-activites",initialParksTabLink:"tab-link-initial-parcs",filteredActivitiesTabLink:"tab-link-filtre-activites",filteredParksTabLink:"tab-link-filtre-parcs",selectionWrapper:"selection-wrapper",label:"selection-label",reserveBtn:"reserve-btn",iframeWrap:"iframe-wrapper"}},this.state={primarySelectionType:null,selectedInitialSlugs:new Set,selectedInitialParkId:null,finalSelectedParkId:null,finalSelectedSlugs:new Set},this.dom={},this.mapItems=[],this.init()}init(){this._setupDomElements()&&(this._injectStyles(),this._injectVideoPlayer(),this._setupEventListeners(),this._applyUrlParameters(),this._setInitialUiState())}_setupDomElements(){for(const e in this.config.ids)if(this.dom[e]=document.getElementById(this.config.ids[e]),!this.dom[e])return console.error(`[SW-RSV] Essential element #${this.config.ids[e]} is missing.`),!1;return this.dom.videoBackgroundDiv=document.querySelector('[data-attribute="video_background"]'),this.dom.resetButton=document.querySelector('[data-attribute="reset_form"]'),this.mapItems=Array.from(this.dom.hiddenMap.querySelectorAll(".map-item")),!0}_setInitialUiState(){this.dom.filteredContainer.style.display="none",this.dom.reserveBtn.classList.add("disabled"),this.dom.iframeWrap.style.display="none",this.dom.selectionWrapper&&(window.gsap.set(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none"}),window.gsap.set(this.dom.label,{opacity:0}))}_setupEventListeners(){this.dom.initialActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"initialActivity")),this.dom.initialParksPane.addEventListener("click",this._handleSelection.bind(this,"initialPark")),this.dom.filteredActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"finalActivity")),this.dom.filteredParksPane.addEventListener("click",this._handleSelection.bind(this,"finalPark")),this.dom.reserveBtn.addEventListener("click",this._handleReserveClick.bind(this)),this.dom.resetButton&&this.dom.resetButton.addEventListener("click",this._fullReset.bind(this))}_handleSelection(e,i){const n=i.target.closest("[data-activity-slug], [data-centre-apex-id]");if(!n)return;const s=n.dataset.activitySlug,o=n.dataset.centreApexId;switch(e){case"initialActivity":this._handleInitialActivitySelection(s,n);break;case"initialPark":this._handleInitialParkSelection(o,n);break;case"finalActivity":this._handleFinalActivitySelection(s,n);break;case"finalPark":this._handleFinalParkSelection(o,n);break}}_handleInitialActivitySelection(e,i){if(this.state.primarySelectionType==="parks"&&(this._resetInitialSelections("parks"),this._resetInitialTabs()),this.state.primarySelectionType="activities",i.classList.toggle("isSelected"),i.classList.contains("isSelected")?this.state.selectedInitialSlugs.add(e):this.state.selectedInitialSlugs.delete(e),this._resetFinalSelections(),this.state.selectedInitialSlugs.size>0){this.dom.initialParksTabLink.style.display="none";const n=Array.from(this.state.selectedInitialSlugs).map(a=>new Set(this.mapItems.filter(r=>r.dataset.activitySlug===a).map(r=>r.dataset.centreApexId))),s=n.length>0?n[0]:new Set,o=n.reduce((a,r)=>new Set([...a].filter(l=>r.has(l))),s);this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(a=>{a.style.display=o.has(a.dataset.centreApexId)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("parks")}else this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this.state.primarySelectionType=null;this._updateStateAndButton()}_handleInitialParkSelection(e,i){this.state.primarySelectionType==="activities"&&(this._resetInitialSelections("activities"),this._resetInitialTabs()),this.state.primarySelectionType="parks";const n=this.state.selectedInitialParkId===e;if(this._resetFinalSelections(),n)this.state.selectedInitialParkId=null,i.classList.remove("isSelected"),this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this._updateVideoSource(null);else{this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(o=>o.classList.remove("isSelected")),this.state.selectedInitialParkId=e,i.classList.add("isSelected"),this._updateVideoSource(i),this.dom.initialActivitiesTabLink.style.display="none";const s=new Set(this.mapItems.filter(o=>o.dataset.centreApexId===e).map(o=>o.dataset.activitySlug));this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(o=>{o.style.display=s.has(o.dataset.activitySlug)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("activities")}this._updateStateAndButton()}_handleFinalParkSelection(e,i){this.state.primarySelectionType==="activities"&&(this.state.finalSelectedParkId===e?(this.state.finalSelectedParkId=null,i.classList.remove("isSelected"),this._updateVideoSource(null)):(this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(n=>n.classList.remove("isSelected")),this.state.finalSelectedParkId=e,i.classList.add("isSelected"),this._updateVideoSource(i)),this._updateStateAndButton())}_handleFinalActivitySelection(e,i){this.state.primarySelectionType==="parks"&&(i.classList.toggle("isSelected"),i.classList.contains("isSelected")?this.state.finalSelectedSlugs.add(e):this.state.finalSelectedSlugs.delete(e),this._updateStateAndButton())}_handleReserveClick(e){if(this.dom.reserveBtn.classList.contains("disabled")){e.preventDefault();return}e.preventDefault();const i=this.dom.reserveBtn.href;if(i&&i!=="#"){this.dom.iframeWrap.innerHTML=`<iframe src="${i}" style="width: 100%; height: 100vh; border: none;"></iframe>`,this.dom.iframeWrap.style.display="block";const n=this.dom.iframeWrap.getBoundingClientRect().top+window.scrollY,o=7*parseFloat(getComputedStyle(document.documentElement).fontSize);window.scrollTo({top:n-o,behavior:"smooth"})}}_updateStateAndButton(){let e=null,i=null;if(this.state.primarySelectionType==="activities"?(e=this.state.finalSelectedParkId,i=this.state.selectedInitialSlugs):this.state.primarySelectionType==="parks"&&(e=this.state.selectedInitialParkId,i=this.state.finalSelectedSlugs),e&&i&&i.size>0){const n=Array.from(i).map(s=>{const o=this.mapItems.find(a=>a.dataset.centreApexId===e&&a.dataset.activitySlug===s);return o?o.dataset.activityApexId:null}).filter(Boolean);if(n.length===i.size){const s=n.join(",");this.dom.reserveBtn.href=`https://www.apex-timing.com/gokarts/sessions_booking.php?center=${e}&categories=${s}&language=fr&iframe_id=axiframe_0`,this.dom.reserveBtn.classList.remove("disabled");const o=this.state.primarySelectionType==="activities"?this.dom.filteredParksPane.querySelector(`[data-centre-apex-id="${e}"]`):this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${e}"]`),a=o?o.dataset.parkLabel:"",r=Array.from(i).map(l=>{const d=this.state.primarySelectionType==="activities"?this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${l}"]`):this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${l}"]`);return d?d.dataset.activityLabel:l});this.dom.label.textContent=`C'est parti pour ${r.map(l=>`un ${l}`).join(" & ")} Ã  ${a} !`,this._animateSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="La combinaison sÃ©lectionnÃ©e est invalide.",this._resetSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="Veuillez terminer votre sÃ©lection.",this._resetSelectionAppearance()}_switchFilteredTab(e){const i="w--current",n=e==="parks"?"Parks":"Activities",s=e==="parks"?"Activities":"Parks";this.dom[`filtered${n}TabLink`].classList.add(i),this.dom[`filtered${s}TabLink`].classList.remove(i),this.dom[`filtered${n}Pane`].classList.add(i),this.dom[`filtered${s}Pane`].classList.remove(i),this.dom[`filtered${n}TabLink`].style.display="inline-block",this.dom[`filtered${n}Pane`].style.display="block",this.dom[`filtered${s}TabLink`].style.display="none",this.dom[`filtered${s}Pane`].style.display="none"}_animateSelectionAppearance(){if(!this.dom.selectionWrapper)return;window.gsap.timeline().to(this.dom.selectionWrapper,{opacity:1,pointerEvents:"auto",duration:.4,ease:"power2.inOut"}).from(this.dom.selectionWrapper,{scale:.9,ease:"elastic.out(1, 0.6)",duration:1.2},"-=0.2").to(this.dom.label,{opacity:1,duration:.5},"-=1")}_resetSelectionAppearance(){this.dom.selectionWrapper&&(window.gsap.to(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none",duration:.3}),window.gsap.to(this.dom.label,{opacity:0,duration:.2}))}_updateVideoSource(e){if(!this.dom.videoBackgroundDiv)return;const i=this.dom.videoBackgroundDiv.querySelector("source"),n=this.dom.videoBackgroundDiv.querySelector("video");if(!i||!n)return;const s=e&&e.dataset.video?e.dataset.video:this.config.defaultVideoUrl;i.src!==s&&(i.src=s,n.load(),n.play().catch(()=>{}))}_fullReset(e){e&&e.preventDefault(),this.state.primarySelectionType=null,this._resetInitialSelections("activities"),this._resetInitialSelections("parks"),this._resetFinalSelections(),this._resetInitialTabs(),this._resetFilteredTabs(),this.dom.filteredContainer.style.display="none",this.dom.iframeWrap.style.display="none",this._updateStateAndButton()}_resetInitialTabs(){this.dom.initialActivitiesTabLink&&(this.dom.initialActivitiesTabLink.style.display="flex"),this.dom.initialParksTabLink&&(this.dom.initialParksTabLink.style.display="flex")}_resetInitialSelections(e){e==="activities"?(this.dom.initialActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(i=>i.classList.remove("isSelected")),this.state.selectedInitialSlugs.clear()):e==="parks"&&(this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(i=>i.classList.remove("isSelected")),this.state.selectedInitialParkId=null,this._updateVideoSource(null))}_resetFinalSelections(){this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedSlugs.clear(),this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedParkId=null}_resetFilteredTabs(){this.dom.filteredActivitiesTabLink.style.display="inline-block",this.dom.filteredParksTabLink.style.display="inline-block"}_injectStyles(){const e=document.createElement("style");e.id="sw-rsv-styles",e.textContent=`
        .isSelected .tags_content { background-color: black !important; color: white !important; }
        .isSelected .tags_content * { color: white !important; }`,document.head.appendChild(e)}_injectVideoPlayer(){this.dom.videoBackgroundDiv.innerHTML=`<video playsinline autoplay muted loop class="background-video_element"><source src="${this.config.defaultVideoUrl}" type="video/mp4"></video>`}_applyUrlParameters(){const e=new URLSearchParams(window.location.search),i=e.get("activite"),n=e.get("parc");!i&&!n||(n&&i?(this.dom.initialParksTabLink&&this.dom.initialParksTabLink.click(),setTimeout(()=>{const s=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${n}"]`);s&&s.click(),setTimeout(()=>{const o=this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${i}"]`);o&&o.click()},100)},100)):i?(this.dom.initialActivitiesTabLink&&this.dom.initialActivitiesTabLink.click(),setTimeout(()=>{const s=this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${i}"]`);s&&s.click()},100)):n&&(this.dom.initialParksTabLink&&this.dom.initialParksTabLink.click(),setTimeout(()=>{const s=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${n}"]`);s&&s.click()},100)))}}function ie(){new te}console.log("ðŸ—ºï¸ map-integration.js v2.0.1 chargÃ©");const S={map:null,markers:[],infoWindow:null,initialCenter:{lat:48.82,lng:2.25},initialZoom:10,initMap:function(){const t=document.getElementById("map");if(!t){console.error("Erreur : L'Ã©lÃ©ment #map est introuvable dans le DOM.");return}const e=t.dataset.mapId;e||console.warn("âš ï¸ data-map-id n'est pas dÃ©fini sur l'Ã©lÃ©ment #map. Les marqueurs avancÃ©s pourraient ne pas fonctionner."),this.map=new google.maps.Map(t,{center:this.initialCenter,zoom:this.initialZoom,disableDefaultUI:!0,zoomControl:!0,mapId:e}),this.infoWindow=new google.maps.InfoWindow,google.maps.event.addListener(this.infoWindow,"closeclick",()=>{this.resetMapView()}),this.createMarkers()},createMarkers:function(){const t=document.querySelectorAll(".w-dyn-item[data-place-id]");console.log(`ðŸ“ ${t.length} cartes trouvÃ©es pour la crÃ©ation des marqueurs.`),t.forEach(e=>{var a,r;const i=parseFloat(e.dataset.lat),n=parseFloat(e.dataset.lng),s=e.dataset.placeId;if(isNaN(i)||isNaN(n)||!s){const l=((a=e.querySelector("h3"))==null?void 0:a.textContent)||"Nom non trouvÃ©";console.warn(`âš ï¸ Carte ignorÃ©e (nom: "${l}") car ses donnÃ©es de latitude/longitude sont manquantes ou invalides.`,e);return}const o=new google.maps.marker.AdvancedMarkerElement({map:this.map,position:{lat:i,lng:n},title:((r=e.querySelector("h3"))==null?void 0:r.textContent)||"Centre Smile World"});o.addListener("click",()=>{this.focusOnCenter(s)}),this.markers.push({placeId:s,marker:o})})},focusOnCenter:async function(t){var e;if(!(!t||!this.map)){console.log(`ðŸ”Ž Zoom sur le centre avec Place ID : ${t}`);try{const{Place:i}=await google.maps.importLibrary("places"),n=new i({id:t}),s=["displayName","formattedAddress","location","rating","googleMapsURI","photos","reviews","userRatingCount","regularOpeningHours"];if(await n.fetchFields({fields:s}),n.location){this.map.panTo(n.location),this.map.setZoom(15);const o=this.buildInfoWindowContent(n);this.infoWindow.setContent(o);const a=(e=this.markers.find(r=>r.placeId===t))==null?void 0:e.marker;a&&this.infoWindow.open(this.map,a)}else console.error(`Aucune donnÃ©e de localisation trouvÃ©e pour le Place ID ${t}`)}catch(i){console.error(`Erreur lors de la rÃ©cupÃ©ration des dÃ©tails pour le Place ID ${t}:`,i)}}},buildInfoWindowContent:function(t){let e="";t.photos&&t.photos.length>0&&(e=`<img src="${t.photos[0].getURI({maxWidth:400,maxHeight:200})}" alt="Photo de ${t.displayName}" style="width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;">`);let i="";t.rating&&(i=`
                <div style="display: flex; align-items: center; color: #555; margin-bottom: 8px; font-size: 14px;">
                    <span style="color: #f8b400; font-size: 18px; margin-right: 8px;">${"â˜…".repeat(Math.round(t.rating))+"â˜†".repeat(5-Math.round(t.rating))}</span>
                    <span style="font-weight: bold; color: #111; margin-right: 5px;">${t.rating.toFixed(1)}</span>
                    <span>(${t.userRatingCount||0} avis)</span>
                </div>`);let n="";if(t.reviews&&t.reviews.length>0){const o=t.reviews[0];o.text&&(n=`
                    <div style="margin-top: 16px;">
                        <strong style="display: block; font-size: 14px; color: #111; margin-bottom: 8px; font-weight: 600;">Dernier avis</strong>
                        <div style="border-left: 3px solid #f0f0f0; padding-left: 12px; font-style: italic;">
                            <p style="margin: 0 0 5px 0; font-size: 13px; color: #555;">"${o.text.substring(0,100)}..."</p>
                            <span style="font-weight: 500; font-size: 12px; color: #333;">- ${o.authorAttribution.displayName}</span>
                        </div>
                    </div>
                `)}let s="";if(t.regularOpeningHours&&t.regularOpeningHours.weekdayDescriptions){const o=new Date().getDay(),a=o===0?6:o-1;s=`<div style="font-size: 13px; color: #333; margin-bottom: 12px; display: flex; align-items: center;"><svg viewBox="0 0 24 24" style="width:16px; height:16px; margin-right: 8px; fill: #555;"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6h6v-2h-4V7z"></path></svg><span>${t.regularOpeningHours.weekdayDescriptions[a]}</span></div>`}return`
            <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; max-width: 290px; padding: 5px;">
                ${e}
                <div style="font-size: 18px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px;">${t.displayName}</div>
                <div style="font-size: 13px; color: #555; margin-bottom: 8px;">${t.formattedAddress}</div>
                ${i}
                ${s}
                <a href="${t.googleMapsURI}" target="_blank" style="display: inline-block; margin-top: 8px; font-size: 13px; color: #1a73e8; text-decoration: none; font-weight: 500;">Voir sur Google Maps</a>
                ${n}
            </div>
        `},resetMapView:function(){this.map&&(console.log("ðŸ”„ RÃ©initialisation de la vue de la carte."),this.infoWindow.close(),this.map.panTo(this.initialCenter),this.map.setZoom(this.initialZoom))}};window.initGoogleMap=S.initMap.bind(S);function ne(){const t=document.getElementById("map");if(!t)return;const e=t.dataset.apiKey;if(!e){console.error(`âŒ ClÃ© API Google Maps manquante. Veuillez l'ajouter dans l'attribut "data-api-key" de la div #map.`);return}if(window.google&&window.google.maps){console.log("ðŸ—ºï¸ Google Maps API dÃ©jÃ  chargÃ©e."),S.initMap();return}console.log("ðŸ—ºï¸ Chargement de l'API Google Maps...");const i=document.createElement("script");i.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places,marker&callback=initGoogleMap&language=fr`,i.async=!0,i.setAttribute("loading","async"),document.head.appendChild(i)}console.log("ðŸšª privateroom.js prÃªt Ã  Ãªtre initialisÃ©");function se(){const t=document.querySelector('[data-attribute="matterport_button"]'),e=document.querySelector('[data-attribute="matterport_popup"]'),i=document.querySelector('[data-attribute="close_popup"]');if(!t||!e||!i){console.warn("-> Ã‰lÃ©ments pour le popup de salle privatisable non trouvÃ©s. Le module ne s'activera pas.");return}console.log("âœ… Popup de salle privatisable initialisÃ©."),window.gsap.set(e,{display:"none",opacity:0,scale:.95,y:"20px"});const n=window.gsap.timeline({paused:!0}).to(e,{display:"flex"}).to(e,{opacity:1,scale:1,y:"0px",duration:.4,ease:"power3.out"}),s=window.gsap.timeline({paused:!0,onComplete:()=>{window.gsap.set(e,{display:"none"})}}).to(e,{opacity:0,scale:.95,y:"20px",duration:.3,ease:"power3.in"}),o=r=>{r.preventDefault(),!(n.isActive()||s.isActive())&&n.restart()},a=r=>{r.preventDefault(),!(n.isActive()||s.isActive())&&s.restart()};t.addEventListener("click",o),i.addEventListener("click",a)}console.log("ðŸ”— preselect.js prÃªt Ã  Ãªtre initialisÃ©");function ae(){const t="[SW-PRESELECT]",e=(...l)=>console.log(new Date().toLocaleTimeString(),t,...l),i="/reservation",n=document.querySelector("[data-preselect-activity-slug], [data-preselect-park-id]");if(!n){console.warn(t,"Aucun Ã©lÃ©ment wrapper avec [data-preselect-activity-slug] ou [data-preselect-park-id] trouvÃ©.");return}const s=document.querySelectorAll('[data-attribute="preselect-booking-button"]');console.log("âœ… Module de prÃ©sÃ©lection initialisÃ©.");const o=n.dataset.preselectActivitySlug,a=n.dataset.preselectParkId,r=new URLSearchParams;if(o&&r.set("activite",o),a&&r.set("parc",a),r.toString()){const l=`${i}?${r.toString()}`;s.forEach(d=>{d.href=l,d.addEventListener("click",function(u){u.preventDefault(),u.stopPropagation(),window.location.href=l},!0)}),e(`Liens de rÃ©servation mis Ã  jour et clics gÃ©rÃ©s pour pointer vers : ${l}`)}}const oe=()=>{const t=document.querySelector(".desktop_menu_content.right .w-dyn-items"),e=document.querySelectorAll(".desktop_menu_list.acitivt-s .default-container");if(!t||!e.length)return;const i=Array.from(t.children).find(a=>{const r=a.querySelector("img");return r&&r.id==="Bowling"});Array.from(t.children).forEach(a=>{a===i?(a.style.opacity="1",a.style.display="block"):(a.style.opacity="0",a.style.display="none")});const n=new Map,s=(a,r)=>{const l=Array.from(t.children).find(d=>{const u=d.querySelector("img");return u&&u.id===a});if(l)if(n.has(l)&&(n.get(l).kill(),n.delete(l)),r){if(i&&i!==l){n.has(i)&&n.get(i).kill();const u=window.gsap.to(i,{opacity:0,duration:.15,ease:"power2.out",onComplete:()=>{i&&(i.style.display="none"),n.delete(i)}});n.set(i,u)}l.style.display="block";const d=window.gsap.to(l,{opacity:1,duration:.15,ease:"power2.out",onComplete:()=>n.delete(l)});n.set(l,d)}else{const d=window.gsap.to(l,{opacity:0,duration:.15,ease:"power2.out",onComplete:()=>{if(l.style.display="none",i){i.style.display="block",n.has(i)&&n.get(i).kill();const u=window.gsap.to(i,{opacity:1,duration:.15,ease:"power2.out",onComplete:()=>n.delete(i)});n.set(i,u)}n.delete(l)}});n.set(l,d)}},o=(a,r)=>{n.has(a)&&(n.get(a).kill(),n.delete(a));const l={duration:r?.1:.05,ease:"power2.out",onComplete:()=>n.delete(a)},d=r?{scale:1.1,backgroundColor:"#FFFFFF"}:{scale:1,backgroundColor:""},u=window.gsap.to(a,{...d,...l});n.set(a,u)};e.forEach(a=>{const r=a.getAttribute("data-name");r&&(a.addEventListener("mouseenter",()=>{s(r,!0),o(a,!0)}),a.addEventListener("mouseleave",()=>{s(r,!1),o(a,!1)}))})};console.log("ðŸš€ main_gsap.js v3.0.1 chargÃ©");function re(){console.log("âœ… GSAP est prÃªt. Initialisation des modules...");try{O(),X(),Y(),ee(),oe(),window.location.pathname.includes("/reservation")&&(console.log("-> Page RÃ©servation dÃ©tectÃ©e via l'URL. Chargement du module..."),ie(),console.log("âœ… Module RÃ©servation chargÃ© et initialisÃ©.")),ne(),document.querySelector(".salles_privatisable_holder")&&(console.log("-> Ã‰lÃ©ment .salles_privatisable_holder dÃ©tectÃ©. Initialisation du module."),se()),document.querySelector('[data-attribute="preselect-booking-button"]')&&(console.log("-> Bouton de prÃ©sÃ©lection dÃ©tectÃ©. Initialisation du module."),ae()),console.log("âœ¨ Tous les modules principaux ont Ã©tÃ© initialisÃ©s."),D()}catch(t){console.error("âŒ Erreur lors de l'initialisation des modules. ForÃ§age du masquage du loader.",t),R()}}function le(){const t=document.querySelector(".page-wrapper");t&&window.gsap.set(t,{autoAlpha:0});let e=0;const i=100,n=setInterval(()=>{window.gsap&&window.gsap.timeline?(clearInterval(n),console.log("âœ… GSAP est prÃªt. Lancement des initialisations..."),W().then(()=>{console.log("ðŸŽ¬ Le loader a terminÃ©, affichage du contenu principal."),t&&window.gsap.to(t,{autoAlpha:1,duration:.4}),re()})):e>i&&(clearInterval(n),console.error("GSAP n'a pas pu Ãªtre chargÃ© aprÃ¨s 10 secondes. Affichage forcÃ© du contenu."),t&&window.gsap.set(t,{autoAlpha:1})),e++},100)}window.Webflow=window.Webflow||[],window.Webflow.push(function(){console.log("ðŸš€ Webflow est prÃªt, lancement de l'attente de GSAP."),le()}),window.addEventListener("load",()=>{console.log("ðŸŽ¬ La page est entiÃ¨rement chargÃ©e. Initialisation des modules dÃ©pendants du contenu."),Q(),z()})})();
