(function(){"use strict";console.log("ðŸš€ loading-screen.js v1.2.0 chargÃ©");const m={fadeOutDuration:.4,ease:"power2.out"};let u=!1,p=!1;function _(){if(console.log("ðŸŽ¬ initLoadingScreen - DÃ©but de l'initialisation"),u)return console.log("â„¹ï¸ Ã‰cran de chargement dÃ©jÃ  initialisÃ©"),Promise.resolve();const i=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");return console.log("ðŸ” Ã‰lÃ©ments trouvÃ©s:",{loadingScreen:!!i,logoWrap:!!e}),!i||!e?(console.warn("âš ï¸ Ã‰lÃ©ments manquants:",{loadingScreen:i?"OK":"Non trouvÃ©",logoWrap:e?"OK":"Non trouvÃ©"}),u=!1,Promise.resolve(null)):(console.log("ðŸŽ¨ Configuration des styles initiaux"),window.gsap.set(i,{opacity:1,display:"flex",backgroundColor:"white"}),window.gsap.set(e,{opacity:0,scale:.9}),window.gsap.to(e,{opacity:1,scale:1,duration:.5,delay:.1,ease:m.ease}),u=!0,console.log("âœ… Ã‰cran de chargement initialisÃ© avec succÃ¨s"),Promise.resolve(i))}function h(){if(console.log("ðŸŽ¬ hideLoadingScreen - DÃ©but du masquage"),!u){console.warn("âš ï¸ Ã‰cran de chargement non initialisÃ©");return}if(p){console.log("â„¹ï¸ Masquage dÃ©jÃ  en cours");return}p=!0;const i=document.querySelector(".loadingscreen"),e=document.querySelector(".loading_logo_wrap");if(console.log("ðŸ” Ã‰lÃ©ments trouvÃ©s pour le masquage:",{loadingScreen:!!i,logoWrap:!!e}),!i||!e){console.warn("âš ï¸ Ã‰lÃ©ments manquants pour le masquage"),p=!1;return}console.log("ðŸŽ¬ DÃ©marrage de l'animation de masquage"),window.gsap.timeline({onComplete:()=>{console.log("âœ… Animation de masquage terminÃ©e"),window.gsap.set(i,{display:"none"}),p=!1}}).to(i,{opacity:0,duration:m.fadeOutDuration,ease:m.ease})}console.log("ðŸš€ text-animation.js v2.1.0 chargÃ©");function P(){const i=document.querySelector(".span_mover");if(i)try{let a=function(){if(t)return;t=!0;const s=gsap.timeline({onComplete:()=>{t=!1,gsap.to(i,{y:e.positions.start,duration:e.duration,ease:e.ease,onComplete:()=>{setTimeout(a,e.cycleDelay*1e3)}})}}),n=[e.positions.start,e.positions.middle,e.positions.end];for(let o=0;o<n.length;o++)s.to(i,{y:n[o],duration:e.duration,ease:e.ease}),o<n.length-1&&s.to({},{duration:e.pauseDuration});s.play()};const e={duration:.6,ease:"back.out(1.7)",pauseDuration:1.5,cycleDelay:.5,positions:{start:"0%",middle:"-34%",end:"-68%"}};let t=!1;a(),window.addEventListener("beforeunload",()=>{gsap.killTweensOf(i)})}catch(e){console.error("Erreur dans l'animation de texte:",e)}}console.log("ðŸš€ faq-toggle.js v2.0.0 chargÃ©");let d=!1;async function v(i){if(!i||!i.classList.contains("is-open"))return;d=!0;const e=i.querySelector(".faq_respond"),t=i.querySelector(".svg-holder.medium");i.classList.remove("is-open"),await window.gsap.to(e,{height:0,opacity:0,duration:.3,ease:"power1.in"}),t&&window.gsap.to(t,{rotation:0,duration:.2,ease:"power1.inOut"}),e.style.display="none",d=!1}async function A(i){if(!i||i.classList.contains("is-open"))return;d=!0;const e=i.querySelector(".faq_respond"),t=i.querySelector(".svg-holder.medium");i.classList.add("is-open"),window.gsap.set(e,{display:"block",height:"auto",opacity:0});const a=e.scrollHeight;t&&window.gsap.to(t,{rotation:90,duration:.3,ease:"back.out(1.7)"}),await window.gsap.fromTo(e,{height:0,opacity:0},{height:a,opacity:1,duration:.5,ease:"elastic.out(1.2, 0.5)"}),d=!1}async function L(i){if(d)return;if(i.classList.contains("is-open"))await v(i);else{const t=document.querySelectorAll(".faq_item.is-open");await Promise.all(Array.from(t).map(a=>v(a))),await A(i)}}function I(){document.querySelectorAll(".faq_item.effect-cartoon-shadow").forEach(e=>{const t=e.querySelector(".faq_wrapper");if(t){if(t.dataset.faqInitialized)return;t.dataset.faqInitialized="true",t.addEventListener("click",a=>{a.target.closest(".faq_respond a, .faq_respond button")||(a.preventDefault(),L(e))})}})}console.log('ðŸš€ menu-desktop.js v14.0.0 chargÃ© - StratÃ©gie "Wrapper"');class q{constructor(){this.activePanel=null,this.isAnimating=!1,this.triggerSelector='[data-attribute^="nav-link-desktop-"]',this.wrapperSelector=".desktop_menu_wrapper",this.panelClassMap={parcs:".parc_menu_desktop",activites:".activites_menu_desktop",offres:".offres_menu_desktop"},this._addGlobalListener(),console.log('âœ… Gestionnaire de clic "StratÃ©gie Wrapper" est actif.')}_addGlobalListener(){document.body.addEventListener("click",e=>{if(this.isAnimating)return;const t=e.target.closest(this.triggerSelector),a=document.querySelector(this.wrapperSelector);if(this.activePanel&&!t&&!this.activePanel.contains(e.target)){this._closeAll();return}if(!t)return;if(e.preventDefault(),e.stopPropagation(),!a){console.error(`Wrapper introuvable avec le sÃ©lecteur: ${this.wrapperSelector}`);return}const s=t.getAttribute("data-attribute").replace("nav-link-desktop-",""),n=a.querySelector(this.panelClassMap[s]);if(!n){console.error(`Panneau cible pour la clÃ© "${s}" non trouvÃ© dans le wrapper.`);return}const o=this.activePanel===n,r=!this.activePanel;o?this._closeAll():r?this._openWrapperAndPanel(n):this._switchPanels(this.activePanel,n)})}_openWrapperAndPanel(e){const t=document.querySelector(this.wrapperSelector);this.isAnimating=!0,window.gsap.set(t,{display:"flex",opacity:0}),Object.values(this.panelClassMap).forEach(a=>{const s=t.querySelector(a);s&&window.gsap.set(s,{display:"none"})}),window.gsap.set(e,{display:"flex"}),window.gsap.to(t,{opacity:1,duration:.3,ease:"power2.out",onComplete:()=>{this.isAnimating=!1,this.activePanel=e}})}_closeAll(){const e=document.querySelector(this.wrapperSelector);!this.activePanel||!e||(this.isAnimating=!0,window.gsap.to(e,{opacity:0,duration:.2,ease:"power1.in",onComplete:()=>{window.gsap.set(e,{display:"none"}),this.activePanel&&window.gsap.set(this.activePanel,{display:"none"}),this.activePanel=null,this.isAnimating=!1}}))}_switchPanels(e,t){this.isAnimating=!0;const a=window.gsap.timeline({onComplete:()=>{this.isAnimating=!1,this.activePanel=t}});a.to(e,{opacity:0,duration:.15,onComplete:()=>window.gsap.set(e,{display:"none"})}),a.set(t,{display:"flex",opacity:0}),a.to(t,{opacity:1,duration:.15})}}function E(){new q}console.log('ðŸš€ menu-mobile.js v4.0.0 chargÃ© - StratÃ©gie "Ultra Patiente"');class C{constructor(){this.selectors={mainPanel:".menu-mobile",openButton:"#hamburger-menu",closeButton:".button-close_menu-mobile",navLinks:{parcs:"#parcs-nav_button_mobile",activites:"#activites-nav_button_mobile",offres:"#formules-nav_button_mobile"},panels:{main:"#main-menu-mobile",parcs:"#parc-menu-mobile",activites:"#activites-menu-mobile",offres:"#offres-menu-mobile"},backButtons:".button-back-menu"},this.activePanelKey="main",this.isAnimating=!1,this._setupEventListeners(),console.log('âœ… Menu Mobile "Ultra Patient" initialisÃ©.')}_setupEventListeners(){document.body.addEventListener("click",e=>{if(this.isAnimating)return;if(e.target.closest(this.selectors.openButton)){e.preventDefault(),this._openMainMenu();return}if(e.target.closest(this.selectors.closeButton)){e.preventDefault(),this._closeMainMenu();return}const t=Object.keys(this.selectors.navLinks).find(a=>e.target.closest(this.selectors.navLinks[a]));if(t){e.preventDefault(),this._navigateToPanel(t);return}if(e.target.closest(this.selectors.backButtons)){e.preventDefault(),this._navigateToPanel("main",!0);return}})}_openMainMenu(){const e=document.querySelector(this.selectors.mainPanel);if(!e)return console.warn("[MenuMobile] Panneau principal .menu-mobile introuvable au clic.");this.isAnimating=!0,window.gsap.set(e,{display:"block",x:"100%"}),window.gsap.to(e,{x:"0%",duration:.5,ease:"power3.out",onComplete:()=>{this.isAnimating=!1}}),document.body.style.overflow="hidden"}_closeMainMenu(){const e=document.querySelector(this.selectors.mainPanel);e&&(this.isAnimating=!0,this._resetToMainPanel(),window.gsap.to(e,{x:"100%",duration:.4,ease:"power3.in",onComplete:()=>{window.gsap.set(e,{display:"none"}),this.isAnimating=!1,document.body.style.overflow=""}}))}_navigateToPanel(e,t=!1){const a=document.querySelector(this.selectors.panels[this.activePanelKey]),s=document.querySelector(this.selectors.panels[e]);if(!a||!s||this.activePanelKey===e)return;this.isAnimating=!0;const n=t?100:-100;window.gsap.set(s,{display:"flex",x:`${-n}%`,opacity:1}),window.gsap.timeline({onComplete:()=>{window.gsap.set(a,{display:"none"}),this.activePanelKey=e,this.isAnimating=!1}}).to(a,{x:`${n}%`,duration:.4,ease:"power2.inOut"}).to(s,{x:"0%",duration:.4,ease:"power2.inOut"},"-=0.4")}_resetToMainPanel(){Object.keys(this.selectors.panels).forEach(e=>{const t=document.querySelector(this.selectors.panels[e]);if(t){const a=e==="main";window.gsap.set(t,{display:a?"flex":"none",x:"0%"})}}),this.activePanelKey="main"}}function T(){new C}console.log("ðŸš€ centre-card.js v6.0.0 chargÃ© â€“ Logique old.js rÃ©intÃ©grÃ©e");const l={CARD:".centre-card_wrapper.effect-cartoon-shadow",CLICKABLE_WRAP:'.clickable_wrap[data-attribute="data-card-toggle"]',TOGGLE_ELEMENTS:[".centre-card_scroll_wrapper",".centre-card_list",".centre-card_button-holder",".tag_holder_wrapper"],ARROW:".svg-holder.arrow",INTERNAL_LINKS:".centre-card_button-holder a, .centre-card_button-holder button"},w=new WeakSet;let f=!1;async function S(i){if(!i||!i.classList.contains("is-open"))return;const e=i.querySelectorAll(l.TOGGLE_ELEMENTS.join(",")),t=i.querySelector(l.ARROW);i.classList.remove("is-open");const a=window.gsap.timeline({onComplete:()=>{window.gsap.set(e,{display:"none"})}});a.to(e,{opacity:0,y:-10,duration:.2,ease:"power1.in",stagger:.02},0),t&&a.to(t,{rotation:0,duration:.25,ease:"power2.inOut"},0),await a}async function M(i){if(!i||i.classList.contains("is-open"))return;i.classList.add("is-open");const e=i.querySelectorAll(l.TOGGLE_ELEMENTS.join(",")),t=i.querySelector(l.ARROW);e.forEach(s=>{window.gsap.set(s,{display:s.dataset.originalDisplay||"block",opacity:0,y:-20})});const a=window.gsap.timeline();t&&a.to(t,{rotation:90,duration:.25,ease:"back.out(1.7)"},"<"),a.to(e,{opacity:1,y:0,duration:.3,ease:"power2.out",stagger:.035},"<0.05"),await a}async function x(i){var e;if(!f){f=!0;try{if(i.classList.contains("is-open"))await S(i),document.dispatchEvent(new CustomEvent("map:reset"));else{const a=document.querySelectorAll(`${l.CARD}.is-open`);await Promise.all(Array.from(a).map(n=>S(n))),await M(i);const s=(e=i.closest(".w-dyn-item"))==null?void 0:e.dataset.placeId;s&&document.dispatchEvent(new CustomEvent("map:focus",{detail:{placeId:s}}))}}finally{f=!1}}}function g(i){if(!i||w.has(i))return;const e=i.parentElement.querySelector(l.CLICKABLE_WRAP);if(!e)return;const t=i.querySelectorAll(l.TOGGLE_ELEMENTS.join(","));t.forEach(s=>{s.dataset.originalDisplay=window.getComputedStyle(s).display}),window.gsap.set(t,{display:"none",opacity:0,y:-20});const a=s=>{s.target.closest(l.INTERNAL_LINKS)||(s.preventDefault(),s.stopPropagation(),x(i))};e.addEventListener("click",a),w.add(i)}function W(){const i=document.querySelector(".collection-list-centre-wrapper");if(!i)return;new MutationObserver(t=>{for(const a of t)a.type==="childList"&&a.addedNodes.forEach(s=>{s.nodeType===1&&(s.matches(l.CARD)&&g(s),s.querySelectorAll(l.CARD).forEach(g))})}).observe(i,{childList:!0,subtree:!0})}function B(){const i=document.querySelectorAll(l.CARD);i.forEach(e=>{e.classList.contains("is-open")&&e.classList.remove("is-open")}),i.forEach(g),W()}function D(){console.group("--- Informations de DÃ©bogage ---"),console.log("Wrapper Menu Desktop:",document.querySelector(".desktop_menu_wrapper")),console.log("Boutons de menu:",{parcs:document.querySelector('[data-attribute="nav-link-desktop-parcs"]'),activites:document.querySelector('[data-attribute="nav-link-desktop-activites"]'),offres:document.querySelector('[data-attribute="nav-link-desktop-offres"]')}),console.log("Conteneurs de menu:",{parcs:document.querySelector(".parc_menu_desktop"),activites:document.querySelector(".activites_menu_desktop"),offres:document.querySelector(".offres_menu_desktop")}),console.groupEnd()}function $(){window.location.hash==="#debug"&&(console.log("ðŸ› Mode de dÃ©bogage activÃ©."),D())}console.log("ðŸ—ºï¸ map-integration.js v2.0.0 chargÃ©");const y={map:null,markers:[],infoWindow:null,initialCenter:{lat:48.82,lng:2.25},initialZoom:10,initMap:function(){const i=document.getElementById("map");if(!i){console.error("Erreur : L'Ã©lÃ©ment #map est introuvable dans le DOM.");return}this.map=new google.maps.Map(i,{center:this.initialCenter,zoom:this.initialZoom,disableDefaultUI:!0,zoomControl:!0,styles:[]}),this.infoWindow=new google.maps.InfoWindow,this.createMarkers(),this.listenForFocusEvents()},createMarkers:function(){const i=document.querySelectorAll(".w-dyn-item[data-place-id]");console.log(`ðŸ“ ${i.length} cartes trouvÃ©es pour la crÃ©ation des marqueurs.`),i.forEach(e=>{var r;const t=parseFloat(e.dataset.lat),a=parseFloat(e.dataset.lng),s=e.dataset.placeId,n=e.getAttribute("id");if(!t||!a||!s){console.warn("âš ï¸ Carte ignorÃ©e car il manque data-lat, data-lng ou data-place-id",e);return}const o=new google.maps.marker.AdvancedMarkerElement({map:this.map,position:{lat:t,lng:a},title:((r=e.querySelector("h3"))==null?void 0:r.textContent)||"Centre Smile World"});o.addListener("click",()=>{const c=e.querySelector('.clickable_wrap[data-attribute="data-card-toggle"]');c?c.click():console.warn("Impossible de trouver l'Ã©lÃ©ment cliquable pour ouvrir la carte",e)}),this.markers.push({placeId:s,cardId:n,marker:o})})},focusOnCenter:function(i){if(!i||!this.map)return;console.log(`ðŸ”Ž Zoom sur le centre avec Place ID : ${i}`),new google.maps.places.PlacesService(this.map).getDetails({placeId:i,fields:["name","formatted_address","geometry","rating","website","url"]},(t,a)=>{var s;if(a===google.maps.places.PlacesServiceStatus.OK&&t&&t.geometry&&t.geometry.location){this.map.panTo(t.geometry.location),this.map.setZoom(15);const n=`
                    <div class="map-infowindow-content">
                        <div class="map-infowindow-title">${t.name}</div>
                        <div class="map-infowindow-address">${t.formatted_address}</div>
                        ${t.rating?`<div class="map-infowindow-rating">Note : ${t.rating} â˜…</div>`:""}
                        <a href="${t.url}" target="_blank">Voir sur Google Maps</a>
                    </div>
                `;this.infoWindow.setContent(n);const o=(s=this.markers.find(r=>r.placeId===i))==null?void 0:s.marker;o&&this.infoWindow.open(this.map,o)}else console.error(`Erreur lors de la rÃ©cupÃ©ration des dÃ©tails pour le Place ID ${i}: ${a}`)})},resetMapView:function(){this.map&&(console.log("ðŸ”„ RÃ©initialisation de la vue de la carte."),this.infoWindow.close(),this.map.panTo(this.initialCenter),this.map.setZoom(this.initialZoom))},listenForFocusEvents:function(){document.addEventListener("map:focus",i=>{this.focusOnCenter(i.detail.placeId)}),document.addEventListener("map:reset",()=>{this.resetMapView()})}};window.initGoogleMap=y.initMap.bind(y);function O(){const i=document.getElementById("map");if(!i)return;const e=i.dataset.apiKey;if(!e){console.error(`âŒ ClÃ© API Google Maps manquante. Veuillez l'ajouter dans l'attribut "data-api-key" de la div #map.`);return}if(window.google&&window.google.maps){console.log("ðŸ—ºï¸ Google Maps API dÃ©jÃ  chargÃ©e."),y.initMap();return}console.log("ðŸ—ºï¸ Chargement de l'API Google Maps...");const t=document.createElement("script");t.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places,marker&callback=initGoogleMap`,t.async=!0,document.head.appendChild(t)}console.log("ðŸš€ main_gsap.js v3.0.1 chargÃ©");function R(){console.log("âœ… GSAP est prÃªt. Initialisation des modules...");try{P(),I(),E(),T(),$(),window.location.pathname.includes("/reservation")&&(console.log("-> Page RÃ©servation dÃ©tectÃ©e via l'URL. Chargement du module..."),Promise.resolve().then(()=>G).then(i=>{i.initReservation(),console.log("âœ… Module RÃ©servation chargÃ© et initialisÃ©.")}).catch(i=>console.error("Ã‰chec du chargement du module de rÃ©servation:",i))),O(),console.log("âœ¨ Tous les modules principaux ont Ã©tÃ© initialisÃ©s."),h()}catch(i){console.error("âŒ Erreur lors de l'initialisation des modules. ForÃ§age du masquage du loader.",i),h()}}function j(){_();let i=0;const e=100,a=setInterval(()=>{window.gsap?(clearInterval(a),R()):(i++,i>e&&(clearInterval(a),console.error("GSAP n'a pas pu Ãªtre chargÃ© aprÃ¨s 10 secondes. Annulation de l'initialisation des modules."),h()))},100)}window.Webflow=window.Webflow||[],window.Webflow.push(function(){console.log("ðŸš€ Webflow est prÃªt, lancement de l'attente de GSAP."),j()}),window.addEventListener("load",()=>{console.log("ðŸŽ¬ La page est entiÃ¨rement chargÃ©e. ForÃ§age de l'Ã©tat des cartes de centre."),B()});class b{constructor(){this.config={defaultVideoUrl:"https://player.vimeo.com/progressive_redirect/playback/1088767237/rendition/1080p/file.mp4?loc=external&signature=1d46b415bde9b315b01d645374b5f7319940ecff5995ac8ac213f847577f6536",ids:{initialContainer:"container-initial",filteredContainer:"container-filtre",hiddenMap:"hidden-map",initialActivitiesPane:"tab-pane-initial-activites",initialParksPane:"tab-pane-initial-parcs",filteredActivitiesPane:"tab-pane-filtre-activites",filteredParksPane:"tab-pane-filtre-parcs",initialActivitiesTabLink:"tab-link-initial-activites",initialParksTabLink:"tab-link-initial-parcs",filteredActivitiesTabLink:"tab-link-filtre-activites",filteredParksTabLink:"tab-link-filtre-parcs",selectionWrapper:"selection-wrapper",label:"selection-label",reserveBtn:"reserve-btn",iframeWrap:"iframe-wrapper"}},this.state={primarySelectionType:null,selectedInitialSlugs:new Set,selectedInitialParkId:null,finalSelectedParkId:null,finalSelectedSlugs:new Set},this.dom={},this.mapItems=[],this.init()}init(){this._setupDomElements()&&(this._injectStyles(),this._injectVideoPlayer(),this._setupEventListeners(),this._applyUrlParameters(),this._setInitialUiState())}_setupDomElements(){for(const e in this.config.ids)if(this.dom[e]=document.getElementById(this.config.ids[e]),!this.dom[e])return console.error(`[SW-RSV] Essential element #${this.config.ids[e]} is missing.`),!1;return this.dom.videoBackgroundDiv=document.querySelector('[data-attribute="video_background"]'),this.dom.resetButton=document.querySelector('[data-attribute="reset_form"]'),this.mapItems=Array.from(this.dom.hiddenMap.querySelectorAll(".map-item")),!0}_setInitialUiState(){this.dom.filteredContainer.style.display="none",this.dom.reserveBtn.classList.add("disabled"),this.dom.iframeWrap.style.display="none",this.dom.selectionWrapper&&(window.gsap.set(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none"}),window.gsap.set(this.dom.label,{opacity:0}))}_setupEventListeners(){this.dom.initialActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"initialActivity")),this.dom.initialParksPane.addEventListener("click",this._handleSelection.bind(this,"initialPark")),this.dom.filteredActivitiesPane.addEventListener("click",this._handleSelection.bind(this,"finalActivity")),this.dom.filteredParksPane.addEventListener("click",this._handleSelection.bind(this,"finalPark")),this.dom.reserveBtn.addEventListener("click",this._handleReserveClick.bind(this)),this.dom.resetButton&&this.dom.resetButton.addEventListener("click",this._fullReset.bind(this))}_handleSelection(e,t){const a=t.target.closest("[data-activity-slug], [data-centre-apex-id]");if(!a)return;const s=a.dataset.activitySlug,n=a.dataset.centreApexId;switch(e){case"initialActivity":this._handleInitialActivitySelection(s,a);break;case"initialPark":this._handleInitialParkSelection(n,a);break;case"finalActivity":this._handleFinalActivitySelection(s,a);break;case"finalPark":this._handleFinalParkSelection(n,a);break}}_handleInitialActivitySelection(e,t){if(this.state.primarySelectionType==="parks"&&(this._resetInitialSelections("parks"),this._resetInitialTabs()),this.state.primarySelectionType="activities",t.classList.toggle("isSelected"),t.classList.contains("isSelected")?this.state.selectedInitialSlugs.add(e):this.state.selectedInitialSlugs.delete(e),this._resetFinalSelections(),this.state.selectedInitialSlugs.size>0){this.dom.initialParksTabLink.style.display="none";const a=Array.from(this.state.selectedInitialSlugs).map(o=>new Set(this.mapItems.filter(r=>r.dataset.activitySlug===o).map(r=>r.dataset.centreApexId))),s=a.length>0?a[0]:new Set,n=a.reduce((o,r)=>new Set([...o].filter(c=>r.has(c))),s);this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(o=>{o.style.display=n.has(o.dataset.centreApexId)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("parks")}else this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this.state.primarySelectionType=null;this._updateStateAndButton()}_handleInitialParkSelection(e,t){this.state.primarySelectionType==="activities"&&(this._resetInitialSelections("activities"),this._resetInitialTabs()),this.state.primarySelectionType="parks";const a=this.state.selectedInitialParkId===e;if(this._resetFinalSelections(),a)this.state.selectedInitialParkId=null,t.classList.remove("isSelected"),this._resetInitialTabs(),this.dom.filteredContainer.style.display="none",this._resetFilteredTabs(),this._updateVideoSource(null);else{this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(n=>n.classList.remove("isSelected")),this.state.selectedInitialParkId=e,t.classList.add("isSelected"),this._updateVideoSource(t),this.dom.initialActivitiesTabLink.style.display="none";const s=new Set(this.mapItems.filter(n=>n.dataset.centreApexId===e).map(n=>n.dataset.activitySlug));this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(n=>{n.style.display=s.has(n.dataset.activitySlug)?"block":"none"}),this.dom.filteredContainer.style.display="flex",this._switchFilteredTab("activities")}this._updateStateAndButton()}_handleFinalParkSelection(e,t){this.state.primarySelectionType==="activities"&&(this.state.finalSelectedParkId===e?(this.state.finalSelectedParkId=null,t.classList.remove("isSelected"),this._updateVideoSource(null)):(this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(a=>a.classList.remove("isSelected")),this.state.finalSelectedParkId=e,t.classList.add("isSelected"),this._updateVideoSource(t)),this._updateStateAndButton())}_handleFinalActivitySelection(e,t){this.state.primarySelectionType==="parks"&&(t.classList.toggle("isSelected"),t.classList.contains("isSelected")?this.state.finalSelectedSlugs.add(e):this.state.finalSelectedSlugs.delete(e),this._updateStateAndButton())}_handleReserveClick(e){if(this.dom.reserveBtn.classList.contains("disabled")){e.preventDefault();return}e.preventDefault();const t=this.dom.reserveBtn.href;if(t&&t!=="#"){this.dom.iframeWrap.innerHTML=`<iframe src="${t}" style="width: 100%; height: 100vh; border: none;"></iframe>`,this.dom.iframeWrap.style.display="block";const a=this.dom.iframeWrap.getBoundingClientRect().top+window.scrollY,n=7*parseFloat(getComputedStyle(document.documentElement).fontSize);window.scrollTo({top:a-n,behavior:"smooth"})}}_updateStateAndButton(){let e=null,t=null;if(this.state.primarySelectionType==="activities"?(e=this.state.finalSelectedParkId,t=this.state.selectedInitialSlugs):this.state.primarySelectionType==="parks"&&(e=this.state.selectedInitialParkId,t=this.state.finalSelectedSlugs),e&&t&&t.size>0){const a=Array.from(t).map(s=>{const n=this.mapItems.find(o=>o.dataset.centreApexId===e&&o.dataset.activitySlug===s);return n?n.dataset.activityApexId:null}).filter(Boolean);if(a.length===t.size){const s=a.join(",");this.dom.reserveBtn.href=`https://www.apex-timing.com/gokarts/sessions_booking.php?center=${e}&categories=${s}&language=fr&iframe_id=axiframe_0`,this.dom.reserveBtn.classList.remove("disabled");const n=this.state.primarySelectionType==="activities"?this.dom.filteredParksPane.querySelector(`[data-centre-apex-id="${e}"]`):this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${e}"]`),o=n?n.dataset.parkLabel:"",r=Array.from(t).map(c=>{const k=this.state.primarySelectionType==="activities"?this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${c}"]`):this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${c}"]`);return k?k.dataset.activityLabel:c});this.dom.label.textContent=`C'est parti pour ${r.map(c=>`un ${c}`).join(" & ")} Ã  ${o} !`,this._animateSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="La combinaison sÃ©lectionnÃ©e est invalide.",this._resetSelectionAppearance()}else this.dom.reserveBtn.href="#",this.dom.reserveBtn.classList.add("disabled"),this.dom.label.textContent="Veuillez terminer votre sÃ©lection.",this._resetSelectionAppearance()}_switchFilteredTab(e){const t="w--current",a=e==="parks"?"Parks":"Activities",s=e==="parks"?"Activities":"Parks";this.dom[`filtered${a}TabLink`].classList.add(t),this.dom[`filtered${s}TabLink`].classList.remove(t),this.dom[`filtered${a}Pane`].classList.add(t),this.dom[`filtered${s}Pane`].classList.remove(t),this.dom[`filtered${a}TabLink`].style.display="inline-block",this.dom[`filtered${a}Pane`].style.display="block",this.dom[`filtered${s}TabLink`].style.display="none",this.dom[`filtered${s}Pane`].style.display="none"}_animateSelectionAppearance(){if(!this.dom.selectionWrapper)return;window.gsap.timeline().to(this.dom.selectionWrapper,{opacity:1,pointerEvents:"auto",duration:.4,ease:"power2.inOut"}).from(this.dom.selectionWrapper,{scale:.9,ease:"elastic.out(1, 0.6)",duration:1.2},"-=0.2").to(this.dom.label,{opacity:1,duration:.5},"-=1")}_resetSelectionAppearance(){this.dom.selectionWrapper&&(window.gsap.to(this.dom.selectionWrapper,{opacity:.5,pointerEvents:"none",duration:.3}),window.gsap.to(this.dom.label,{opacity:0,duration:.2}))}_updateVideoSource(e){if(!this.dom.videoBackgroundDiv)return;const t=this.dom.videoBackgroundDiv.querySelector("source"),a=this.dom.videoBackgroundDiv.querySelector("video");if(!t||!a)return;const s=e&&e.dataset.video?e.dataset.video:this.config.defaultVideoUrl;t.src!==s&&(t.src=s,a.load(),a.play().catch(()=>{}))}_fullReset(e){e&&e.preventDefault(),this.state.primarySelectionType=null,this._resetInitialSelections("activities"),this._resetInitialSelections("parks"),this._resetFinalSelections(),this._resetInitialTabs(),this._resetFilteredTabs(),this.dom.filteredContainer.style.display="none",this.dom.iframeWrap.style.display="none",this._updateStateAndButton()}_resetInitialTabs(){this.dom.initialActivitiesTabLink&&(this.dom.initialActivitiesTabLink.style.display="flex"),this.dom.initialParksTabLink&&(this.dom.initialParksTabLink.style.display="flex")}_resetInitialSelections(e){e==="activities"?(this.dom.initialActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(t=>t.classList.remove("isSelected")),this.state.selectedInitialSlugs.clear()):e==="parks"&&(this.dom.initialParksPane.querySelectorAll("[data-centre-apex-id]").forEach(t=>t.classList.remove("isSelected")),this.state.selectedInitialParkId=null,this._updateVideoSource(null))}_resetFinalSelections(){this.dom.filteredActivitiesPane.querySelectorAll("[data-activity-slug]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedSlugs.clear(),this.dom.filteredParksPane.querySelectorAll("[data-centre-apex-id]").forEach(e=>e.classList.remove("isSelected")),this.state.finalSelectedParkId=null}_resetFilteredTabs(){this.dom.filteredActivitiesTabLink.style.display="inline-block",this.dom.filteredParksTabLink.style.display="inline-block"}_injectStyles(){const e=document.createElement("style");e.id="sw-rsv-styles",e.textContent=`
        .isSelected .tags_content { background-color: black !important; color: white !important; }
        .isSelected .tags_content * { color: white !important; }`,document.head.appendChild(e)}_injectVideoPlayer(){this.dom.videoBackgroundDiv&&(this.dom.videoBackgroundDiv.innerHTML=`
        <div style="width: 100%; height: 100%;" class="w-background-video w-background-video-atom">
          <video playsinline loop muted autoplay data-wf-ignore="true" data-object-fit="cover">
            <source src="${this.config.defaultVideoUrl}" data-wf-ignore="true"/>
          </video>
        </div>`)}_applyUrlParameters(){const e=new URLSearchParams(window.location.search),t=e.get("activite"),a=e.get("parc");!t&&!a||setTimeout(()=>{if(a&&t){const s=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${a}"]`);if(s){this._handleInitialParkSelection(a,s);const n=this.dom.filteredActivitiesPane.querySelector(`[data-activity-slug="${t}"]`);n&&this._handleFinalActivitySelection(t,n)}}else if(a){const s=this.dom.initialParksPane.querySelector(`[data-centre-apex-id="${a}"]`);s&&s.click()}else if(t){const s=this.dom.initialActivitiesPane.querySelector(`[data-activity-slug="${t}"]`);s&&s.click()}},100)}}function F(){new b}const G=Object.freeze(Object.defineProperty({__proto__:null,SmileWorldReservation:b,initReservation:F},Symbol.toStringTag,{value:"Module"}))})();
